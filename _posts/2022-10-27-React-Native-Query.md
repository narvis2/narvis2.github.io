---
title: React-Native React-Query
author: Narvis2
date: 2022-08-25 16:19:00 +0900
categories: [React-Native, React-Query]
tags: [react-query, react-native, useQuery, useMutation]
---

ÏïàÎÖïÌïòÏÑ∏Ïöî. Narvis2 ÏûÖÎãàÎã§.  
Ïù¥Î≤à ÏãúÍ∞ÑÏóêÎäî ÏÑúÎ≤ÑÏùò Í∞íÏùÑ client Ïóê Í∞ÄÏ†∏Ïò§Í±∞ÎÇò Ï∫êÏã±, Í∞í ÏóÖÎç∞Ïù¥Ìä∏, ÏóêÎü¨ Ìï∏Îì§ÎßÅ Îì± ÎπÑÎèôÍ∏∞ Í≥ºÏ†ïÏùÑ ÎçîÏö± Ìé∏ÌïòÍ≤å ÌïòÎäîÎç∞ ÏÇ¨Ïö©ÌïòÎäî `react-query`Ïóê ÎåÄÌïòÏó¨ ÏïåÏïÑÎ≥¥Í≤†ÏäµÎãàÎã§.

## üö© React-Query

- üç¨ ÏÑúÎ≤ÑÏùò Í∞íÏùÑ client Ïóê Í∞ÄÏ†∏Ïò§Í±∞ÎÇò Caching, value updating, error handling Îì± **_ÎπÑÎèôÍ∏∞ Í≥ºÏ†ïÏùÑ ÎçîÏö± Ìé∏ÌïòÍ≤å_** ÌïòÎäîÎç∞ ÏÇ¨Ïö©Îê®
- ÏÑúÎ≤ÑÏôÄ ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏Î•º Î∂ÑÎ¶¨Ìï©ÎãàÎã§.

### üçÄ 1. React-Query Ïû•Ï†ê

- Ï∫êÏã±
  - `get`ÏùÑ Ìïú Îç∞Ïù¥ÌÑ∞Ïóê ÎåÄÌï¥ `update`Î•º ÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú `get`ÏùÑ Îã§Ïãú ÏàòÌñâÌïúÎã§.
  - Ex üëâ Í≤åÏãúÌåêÏùò Í∏ÄÏùÑ Í∞ÄÏ†∏ÏôîÏùÑ Îïå Í≤åÏãúÌåêÏùò Í∏ÄÏùÑ ÏÉùÏÑ±ÌïòÎ©¥ Í≤åÏãúÌåê Í∏ÄÏùÑ `get`ÌïòÎäî `api`Î•º ÏûêÎèôÏúºÎ°ú Ïã§ÌñâÌï† Ïàò ÏûàÏùå
  - Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò§ÎûòÎêòÏóàÎã§Í≥† ÌåêÎã®ÎêòÎ©¥ Îã§Ïãú `get` (`invalidateQueries`)
  - ÎèôÏùº Îç∞Ïù¥ÌÑ∞Î•º Ïó¨Îü¨Î≤à ÏöîÏ≤≠ÌïòÎ©¥ ÌïúÎ≤àÎßå ÏöîÏ≤≠ÌïúÎã§. (Option Ïóê Îî∞Îùº Ï§ëÎ≥µ Ìò∏Ï∂ú, ÌóàÏö© ÏãúÍ∞Ñ Ï°∞Ï†à Í∞ÄÎä•)
- Î¨¥Ìïú Ïä§ÌÅ¨Î°§
  - `Infinite Queries`Î•º ÏÇ¨Ïö©ÌïòÏó¨ pagination Ï≤òÎ¶¨ Í∞ÄÎä•
- ÎπÑÎèôÍ∏∞ Í≥ºÏ†ïÏùÑ ÏÑ†Ïñ∏Ï†ÅÏúºÎ°ú Í¥ÄÎ¶¨Í∞Ä Í∞ÄÎä•ÌïòÎã§.
- react Ïùò `Hook`Í≥º ÏÇ¨Ïö©ÌïòÎäî Íµ¨Ï°∞Í∞Ä ÎπÑÏä∑ÌïòÎã§.

### üçÄ 2. useQuery

- Îç∞Ïù¥ÌÑ∞Î•º `get` ÌïòÍ∏∞ ÏúÑÌïú `api` (post, update Îäî `useMutation` ÏùÑ ÏÇ¨Ïö©)
- Ï≤´ Î≤àÏß∏ ÌååÎùºÎØ∏ÌÑ∞
  - `Unique Key`Í∞Ä Îì§Ïñ¥Í∞ê, **_ÏöîÏ≤≠Ïùò Í≤∞Í≥ºÎ¨ºÏù¥ ÌäπÏ†ï Î≥ÄÏàòÏóê Îî∞Îùº Îã¨ÎùºÏßÑÎã§Î©¥_** Íº≠ `Unique key`Ïóê Ìè¨Ìï®Ìï¥Ïïº Ìï®
  - `Unique key`Îäî String Í≥º []ÏùÑ Î∞õÎäîÎã§. Î∞∞Ïó¥Î°ú ÎÑòÍ∏∞Î©¥ 0Î≤à Í∞íÏùÄ String Í∞íÏúºÎ°ú Îã§Î•∏ ComponentÏóêÏÑú Î∂ÄÎ•º Í∞íÏù¥ Îì§Ïñ¥Í∞ÄÍ≥† Îëê Î≤àÏß∏ Í∞íÏùÑ ÎÑ£ÏúºÎ©¥ Query Ìï®Ïàò ÎÇ¥Î∂ÄÏóê ÌååÎùºÎØ∏ÌÑ∞Î°ú Ìï¥Îãπ Í∞íÏù¥ Ï†ÑÎã¨Îê®
- Îëê Î≤àÏß∏ ÌååÎùºÎØ∏ÌÑ∞
  - ÎπÑÎèôÍ∏∞ Ìï®Ïàò(api Ìò∏Ï∂ú Ìï®Ïàò)Í∞Ä Îì§Ïñ¥Í∞ê (`promise`Í∞Ä Îì§Ïñ¥Í∞ÄÏïº Ìï®)
  - Ïù¥ Component Í∞Ä ÎûúÎçîÎßÅÎê† Îïå Ìï¥Îãπ Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥†, Ïù¥Ïóê ÎåÄÌïú ÏÉÅÌÉúÍ∞Ä Í¥ÄÎ¶¨Îê®
- Ï≤´ Î≤àÏß∏ ÌååÎùºÎØ∏ÌÑ∞Î°ú ÏÑ§Ï†ïÌïú `Unique Key`Îäî Îã§Î•∏ Component ÏóêÏÑúÎèÑ Ìï¥Îãπ `key`Î•º ÏÇ¨Ïö©ÌïòÎ©¥ Ìò∏Ï∂ú Í∞ÄÎä•
- `Return` Í∞í
  - Api ÏöîÏ≤≠Ïùò ÏÑ±Í≥µ, Ïã§Ìå® Ïó¨Î∂Ä Î∞è Api Í≤∞Í≥º Í∞íÏùÑ Ìè¨Ìï®Ìïú Í∞ùÏ≤¥
  - > `status` üëâ APIÏùò ÏöîÏ≤≠ ÏÉÅÌÉúÎ•º Î¨∏ÏûêÏó¥Î°ú ÎÇòÌÉÄÎÉÑ
    - > `loading` üëâ ÏïÑÏßÅ Îç∞Ïù¥ÌÑ∞Î•º Î∞õÏïÑÏò§ÏßÄ ÏïäÍ≥†, ÌòÑÏû¨ Îç∞Ïù¥ÌÑ∞Î•º ÏöîÏ≤≠ Ï§ë
    - > `error` üëâ Ïò§Î•ò Î∞úÏÉù
    - > `success` üëâ Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠ ÏÑ±Í≥µ
    - > `idle` üëâ ÎπÑÌôúÏÑ±ÌôîÎêú ÏÉÅÌÉú(Îî∞Î°ú ÏÑ§Ï†ïÌï¥ ÎπÑÌôúÏÑ±ÌôîÌïú Í≤ΩÏö∞)
  - > `isLoading` üëâ status === 'loading' Í≥º Í∞ôÏùå
  - > `isError` üëâ status === 'error' ÏôÄ Í∞ôÏùå
  - > `isSuccess` üëâ staus === 'success' ÏôÄ Í∞ôÏùå
  - > `isIdle` üëâ staus === 'idle' Í≥º Í∞ôÏùå
  - > `error` üëâ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏùÑ Îïå Ïò§Î•ò Ï†ïÎ≥¥Î•º Í∞ÄÏßÄÍ≥† ÏûàÏùå
  - > `data` üëâ ÏöîÏ≤≠ ÏÑ±Í≥µÌïú Îç∞Ïù¥ÌÑ∞Î•º Í∞ÄÎ¶¨ÌÇ¥
  - > `isFetching` üëâ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏöîÏ≤≠ Ï§ëÏùº Îïå trueÍ∞Ä Îê®
    - > Îç∞Ïù¥ÌÑ∞Í∞Ä Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî ÏÉÅÌÉúÏóêÏÑú Ïû¨ÏöîÏ≤≠Ìï† Îïå `isLoading` ÏùÄ false Ïù¥ÏßÄÎßå, `isFetching` ÏùÄ true ÏûÑ
  - > `refetch` üëâ Îã§Ïãú ÏöîÏ≤≠ÏùÑ ÏãúÏûëÌïòÎäî Ìï®Ïàò
- ÎπÑÎèôÍ∏∞Î°ú ÏûëÎèô
  - Ïó¨Îü¨Í∞úÏùò ÎπÑÎèôÍ∏∞ `Query`Í∞Ä ÏûàÎã§Î©¥ `useQuery` Î≥¥Îã§Îäî `useQueries` Î•º ÏÇ¨Ïö©ÌïòÎäî Í≤ÉÏù¥ Ï¢ãÏùå
- `enabled` Î•º ÏÇ¨Ïö©ÌïòÎ©¥ `useQuery` Î•º ÎèôÍ∏∞Ï†ÅÏúºÎ°ú ÏÇ¨Ïö© Í∞ÄÎä•
  - `useQuery`Ïùò 3Î≤àÏß∏ Ïù∏ÏûêÎ°ú `Option` Í∞íÏù¥ Îì§Ïñ¥Í∞ÄÎäîÎç∞ Í∑∏ `Option`Ïùò `enabled`Ïóê Í∞íÏùÑ ÎÑ£ÏúºÎ©¥ `enabled` Í∞íÏù¥ `true` ÏùºÎïå `useQuery`Î•º Ïã§ÌñâÌï®
- `useQuery Option`
  - `enable` üëâ boolean ÌÉÄÏûÖÏùò Í∞íÏùÑ ÏÑ§Ï†ï, Ïù¥ Í∞íÏù¥ false Ïù¥Î©¥ Component Í∞Ä ÎßàÏö¥Ìä∏Îê† Îïå ÏûêÎèôÏúºÎ°ú ÏöîÏ≤≠ÌïòÏßÄ ÏïäÏùå. **_refetch Ìï®ÏàòÎ°úÎßå ÏöîÏ≤≠Ïù¥ ÏãúÏûëÎê®_**
  - `retry` üëâ boolean | number | (failureCount: number, error: TError) => boolean ÌÉÄÏûÖÏùò Í∞íÏùÑ ÏÑ§Ï†ï
    - ÏöîÏ≤≠Ïù¥ Ïã§Ìå®ÌñàÏùÑ Îïå Ïû¨ÏöîÏ≤≠Ìï†ÏßÄ ÏÑ§Ï†ïÌï† Ïàò ÏûàÏùå
    - > Ïù¥ Í∞íÏùÑ `true`Î°ú ÌñàÏùÑÎïå üëâ Ïã§Ìå®ÌñàÏùÑ Îïå ÏÑ±Í≥µÌï† ÎïåÍπåÏßÄ Í≥ÑÏÜç Î∞òÎ≥µ ÏöîÏ≤≠
    - > Ïù¥ Í∞íÏùÑ `false`Î°ú ÌñàÏùÑÎïå üëâ Ïã§Ìå®ÌñàÏùÑ ÎñÑ Ïû¨ÏöîÏ≤≠ÌïòÏßÄ ÏïäÏùå
    - > Ïù¥ Í∞íÏùÑ `3` ÏúºÎ°ú ÌïòÎ©¥ üëâ 3Î≤àÍπåÏßÄÎßå Ïû¨ÏöîÏ≤≠
    - > Ïù¥ Í∞íÏùÑ `Ìï®Ïàò ÌÉÄÏûÖ`ÏúºÎ°ú ÏÑ§Ï†ïÌïòÎ©¥ üëâ Ïã§Ìå® ÌöüÏàòÏôÄ Ïò§Î•ò ÌÉÄÏûÖÏóê Îî∞Îùº Ïû¨ÏöîÏ≤≠Ìï†ÏßÄ Ìï®Ïàò ÎÇ¥ÏóêÏÑú Í≤∞Ï†ïÌï† Ïàò ÏûàÏùå
  - `retryDelay` üëâ number | (retryAttempt: number, error: TError) => number ÌÉÄÏûÖ Í∞íÏùÑ ÏÑ§Ï†ï
    - ÏãúÍ∞Ñ Îã®ÏúÑÎäî ms(Î∞ÄÎ¶¨ÏÑ∏Ïª®Îìú 0.001Ï¥à)ÏûÑ
    - > Í∏∞Î≥∏Í∞í üëâ (retryAttempt) => Math.min(1000 \* 2 \*\* failureCount, 30000)
    - > Ïã§Ìå® ÌöüÏàò n Ïóê Îî∞Îùº 2Ïùò n Ï†úÍ≥± Ï¥àÎßåÌÅº Í∏∞Îã§Î†∏Îã§Í∞Ä Ïû¨ÏöîÏ≤≠ÌïòÍ≥† ÏµúÎåÄ 30Ï¥àÍπåÏßÄ Í∏∞Îã§Î¶º
  - `staleTime` üëâ Îç∞Ïù¥ÌÑ∞Ïùò Ïú†Ìö® ÏãúÍ∞ÑÏùÑ ms Îã®ÏúÑÎ°ú ÏÑ§Ï†ï, Í∏∞Î≥∏Í∞í 0 (Îç∞Ïù¥ÌÑ∞Î•º Ï°∞ÌöåÌïú ÏàúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Îäî Î∞îÎ°ú Ïú†Ìö®ÌïòÏßÄ ÏïäÍ≤å Îê®)
  - `cacheTime` üëâ Îç∞Ïù¥ÌÑ∞Ïùò Ï∫êÏãú ÏãúÍ∞ÑÏùÑ ms Îã®ÏúÑÎ°ú ÏÑ§Ï†ï, Í∏∞Î≥∏Í∞íÏùÄ 5Î∂Ñ, Ï∫êÏãú ÏãúÍ∞ÑÏùÄ HookÏùÑ ÏÇ¨Ïö©ÌïòÎäî Component Í∞Ä Ïñ∏ÎßàÏö¥Ìä∏ÎêòÍ≥† ÎÇòÏÑú Ìï¥Îãπ Îç∞Ïù¥ÌÑ∞Î•º ÏñºÎßàÎÇò Ïú†ÏßÄÌï†ÏßÄ Í≤∞Ï†ïÌï®
    > **_üçÄ Ï∞∏Í≥† üçÄ_** `staleTime` Í≥º `cacheTime` Ïùò Ï∞®Ïù¥ üëá
    >
    > - `useQuery` Î•º ÏÇ¨Ïö©Ìï† Îïå `staleTime` ÏòµÏÖòÏùÄ Í∏∞Î≥∏Í∞íÏù¥ 0 ÏûÑ. Ï¶â, **_Îç∞Ïù¥ÌÑ∞Î•º Ï°∞ÌöåÌïú ÏàúÍ∞Ñ Îç∞Ïù¥ÌÑ∞Îäî Î∞îÎ°ú Ïú†Ìö®ÌïòÏßÄ ÏïäÍ≤åÎê®_**. Îç∞Ïù¥ÌÑ∞Í∞Ä Ïú†Ìö®ÌïòÏßÄ ÏïäÎã§Î©¥ Í∏∞ÌöåÍ∞Ä Ï£ºÏñ¥Ï°åÏùÑ Îïå Îã§Ïãú ÏöîÏ≤≠ÌïòÏó¨ Îç∞Ïù¥ÌÑ∞Î•º ÏµúÏã†Ìôî Ìï¥ÏïºÌï®
    > - Ïû¨ÏöîÏ≤≠ Í∏∞ÌöåÍ∞Ä Ï£ºÏñ¥ÏßÄÎäî ÏãúÏ†ê : ÎòëÍ∞ôÏùÄ `Cache key` Î•º ÏÇ¨Ïö©ÌïòÎäî `useQuery` Î•º ÏÇ¨Ïö©Ï§ëÏù∏ Component Í∞Ä ÎßàÏö¥Ìä∏Îê† Îïå
    > - `cacheTime`ÏùÄ `useQuery Hook`ÏùÑ ÏÇ¨Ïö©Ìïú ComponentÍ∞Ä Ïñ∏ÎßàÏö¥Ìä∏ÎêòÍ≥† ÎÇòÏÑú Ìï¥Îãπ Îç∞Ïù¥ÌÑ∞Î•º ÏñºÎßà ÎèôÏïà Ïú†ÏßÄÌï†ÏßÄÏóê ÎåÄÌïú ÏÑ§Ï†ï, Í∏∞Î≥∏Í∞íÏùÄ 5
    > - ÎßåÏïΩ `useQuery`Î•º ÏÇ¨Ïö©Ìïú Component Í∞Ä Ïñ∏ÎßàÏö¥Ìä∏ÎêòÍ≥† ÎÇòÏÑú 5Î∂ÑÏïàÏóê Îã§Ïãú ÎßàÏö¥Ìä∏ÎêúÎã§Î©¥ isLoading Í∞íÏù¥ trueÎ°ú ÎêòÏßÄ ÏïäÍ≥†, Ï≤òÏùå Î†åÎçîÎßÅÌïòÎäî ÏãúÏ†êÎ∂ÄÌÑ∞ data Í∞íÏù¥ Ïù¥Ï†ÑÏóê Î∂àÎü¨Ïò® Îç∞Ïù¥ÌÑ∞Î°ú Ï±ÑÏõåÏ†∏ ÏûàÍ≤å ÎêúÎã§. Í∑∏Î¶¨Í≥† `staleTime`Ïóê Îî∞Îùº Ìï¥Îãπ Îç∞Ïù¥ÌÑ∞Í∞Ä Ïú†Ìö®ÌïòÎã§Î©¥ Ïû¨ÏöîÏ≤≠ÌïòÏßÄ ÏïäÍ≥†, Ïú†Ìö®ÌïòÏßÄ ÏïäÎã§Î©¥ Ïû¨ÏöîÏ≤≠ÌïúÎã§.
  - `refetchInterval` üëâ false | number ÌÉÄÏûÖÍ∞íÏùÑ ÏÑ§Ï†ï
    - Ïù¥ ÏÑ§Ï†ïÏúºÎ°ú nÏ¥àÎßàÎã§ Îç∞Ïù¥ÌÑ∞Î•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÎèÑÎ°ù ÏÑ§Ï†ïÌï† Ïàò ÏûàÏùå
    - ÏãúÍ∞Ñ Îã®ÏúÑÎäî ms ÏûÑ
  - `refetchOnmount` üëâ boolean | 'always' ÌÉÄÏûÖÏùò Í∞íÏùÑ ÏÑ§Ï†ï
    - Ïù¥ ÏÑ§Ï†ïÏúºÎ°ú ComponentÍ∞Ä ÎßàÏö¥Ìä∏Îê† Îïå Ïû¨ÏöîÏ≤≠ÌïòÎäî Î∞©ÏãùÏùÑ ÏÑ§Ï†ïÌï† Ïàò ÏûàÏùå
    - > Í∏∞Î≥∏ Í∞í: true
    - > trueÏùº ÎïåÎäî Îç∞Ïù¥ÌÑ∞Í∞Ä Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÑ Îïå Ïû¨ÏöîÏ≤≠Ìï®
    - > falseÏùº ÎïåÎäî ComponentÍ∞Ä Îã§Ïãú ÎßàÏö¥Ìä∏ÎêòÏñ¥ÎèÑ Ïû¨ÏöîÏ≤≠ÌïòÏßÄ ÏïäÏùå
    - > 'always'Ïùº ÎïåÎäî Îç∞Ïù¥ÌÑ∞Ïùò Ïú†Ìö® Ïó¨Î∂ÄÏôÄ Í¥ÄÍ≥ÑÏóÜÏù¥ Î¨¥Ï°∞Í±¥ Ïû¨ÏöîÏ≤≠Ìï®
  - `onSuccess` üëâ (data: Data) => void ÌÉÄÏûÖÏùò Ìï®ÏàòÎ•º ÏÑ§Ï†ï, Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïù¥ ÏÑ±Í≥µÌïòÍ≥† ÎÇòÏÑú ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥† Ïã∂ÏùÑ Îïå ÏÇ¨Ïö©
  - `onError` üëâ (error: Error) => void ÌÉÄÏûÖÏùò Ìï®ÏàòÎ•º ÏÑ§Ï†ï, Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïù¥ Ïã§Ìå®ÌïòÍ≥† ÎÇòÏÑú ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥† Ïã∂ÏùÑ Îïå ÏÇ¨Ïö©
  - `onSettled` üëâ (data?: Data, error?: Error) => void ÌÉÄÏûÖÏùò Ìï®ÏàòÎ•º ÏÑ§Ï†ï, Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïùò ÏÑ±Í≥µ Ïó¨Î∂ÄÏôÄ Í¥ÄÍ≥ÑÏóÜÏù¥ ÏöîÏ≤≠Ïù¥ ÎÅùÎÇòÎ©¥ ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÎèÑÎ°ù ÏÑ§Ï†ï
  - `initialData` üëâ Data | () => Data ÌÉÄÏûÖÏùò Í∞íÏùÑ ÏÑ§Ï†ï, `Hook` ÏóêÏÑú ÏÇ¨Ïö©Ìï† Îç∞Ïù¥ÌÑ∞Ïùò Ï¥àÍπÉÍ∞íÏùÑ ÏßÄÏ†ïÌïòÍ≥† Ïã∂ÏùÑ Îïå ÏÇ¨Ïö©
  - `refetchOnWindowFocus` üëâ `React-Query`Îäî ÏÇ¨Ïö©ÏûêÍ∞Ä ÏÇ¨Ïö©ÌïòÎäî ÏúàÎèÑÏö∞Í∞Ä Îã§Î•∏ Í≥≥ÏùÑ Í∞îÎã§Í∞Ä Îã§Ïãú ÌôîÎ©¥ÏúºÎ°ú ÎèåÏïÑÏò§Î©¥ Ïù¥ Ìï®ÏàòÎ•º Ïû¨Ïã§ÌñâÌï®, Í∑∏ Ïû¨Ïã§Ìñâ Ïó¨Î∂Ä ÏòµÏÖò

> **_ÏòàÏ†ú üëá_** Í∏∞Î≥∏ ÏÑ§Ï†ï > index.js Ïóê ÏûëÏÑ±
>
> >

```javascript
import { QueryClient, QueryClientProvider } from "react-query";
import { ReactQueryDevtools } from "react-query/devtools";

const queryClient = new QueryClient();
const root = ReactDOM.createRoot(documnet.getElementById("root"));

root.Render(
  <React.StrictMode>
    <QueryClientProvider client={queryClient}>
      <ReactQueryDevtools initialIsOpen={true} />
      <App />
    </QueryClientProvider>
  </React.StrictMode>
);
```

> **_ÏòàÏ†ú üëá_** `useQuery` ÏÇ¨Ïö©
>
> >

```javascript
const Todo = () => {
  const { isLoading, isError, data, error } = useQuery("todos", fetchTodoList, {
    refetchOnWindowFocus: false,
    retry: 0,
    onSuccess: (data) => {
      console.log(data);
    },
    onError: (e) => {
      console.log(e.message);
    },
  });

  if (isLoading) {
    return (
      <View>
        <Text>{"Loading"}</Text>
      </View>
    );
  }

  if (isError) {
    return (
      <View>
        <Text>{"ÏóêÎü¨"}</Text>
      </View>
    );
  }

  // Something...
};
```

### üçÄ 3. useQueries

- `useQuery`Î•º ÎπÑÎèôÍ∏∞Î°ú Ïó¨Îü¨Í∞ú Ïã§ÌñâÌï† Í≤ΩÏö∞ ÏÇ¨Ïö©
- `promise.all`Í≥º ÎßàÏ∞¨Í∞ÄÏßÄÎ°ú ÌïòÎÇòÏùò Î∞∞Ïó¥Ïóê Í∞Å `Query`Ïóê ÎåÄÌïú ÏÉÅÌÉú Í∞íÏù¥ Í∞ùÏ≤¥Î°ú Îì§Ïñ¥Ïò¥

> **_ÏòàÏ†ú üëá_** `useQueries` ÏÇ¨Ïö© (lol Î£¨Í≥º Ïä§Ìé†ÏùÑ Î∞õÏïÑÏò§Îäî ÏòàÏãú)
>
> >

```javascript
const result = useQueries([
  /**
   * getRune -> Unique Key
   * riot.version -> ÌååÎùºÎØ∏ÌÑ∞
   */
  {
    queryKey: ["getRune", riot.version],
    queryFn: () => api.getRunInfo(riot.version),
  },
  {
    queryKey: ["getSpell", riot.version],
    queryFn: () => api.getSpellInfo(riot.version),
  },
]);

useEffect(() => {
  console.log(result);
  const loadingFinishAll = result.some((result) => result.isLoading);
  console.log(loadingFinishAll);
}, [result]);
```

> **_ÏòàÏ†ú üëá_** `useQueries` ÏÇ¨Ïö© > `Unique Key` ÌôúÏö© > `Unique Key`Î•º Î∞∞Ïó¥Î°ú ÎÑ£ÏúºÎ©¥ `queryFn(ÏøºÎ¶¨ Ìï®Ïàò)` ÎÇ¥Î∂ÄÏóêÏÑú Î≥ÄÏàòÎ°ú ÏÇ¨Ïö© Í∞ÄÎä•
>
> >

```javascript
const result = useQueries([
  {
    queryKey: ["getRune", riot.version],
    queryFn: (params) => {
      // Í≤∞Í≥º -> {queryKey: ['getRune', '12.1.1'], pageParam: undifined, meta: undifined}
      console.log(params);
      return api.getRunInfo(riot.version);
    },
  },
  {
    queryKey: ["getSpell", riot.version],
    queryFn: () => api.getSpellInfo(riot.version),
  },
]);
```

### üçÄ 4. useMutation

- Í∞íÏùÑ Î∞îÍøÄ Îïå ÏÇ¨Ïö©ÌïòÎäî api
- Îç∞Ïù¥ÌÑ∞Î•º ÏÉùÏÑ±(`POST`), ÏàòÏ†ï(`UPDATE`), ÏÇ≠Ï†ú(`DELETE`)Ìï† ÎñÑ ÏÇ¨Ïö©ÌïòÎäî `Hook`
- **_ÌäπÏ†ï Ìï®ÏàòÏóêÏÑú Ïö∞Î¶¨Í∞Ä ÏõêÌïòÎäî ÎïåÏóê ÏßÅÏ†ë ÏöîÏ≤≠ÏùÑ ÏãúÏûëÌïòÎäî ÌòïÌÉú_**
- ÏöîÏ≤≠ Í¥ÄÎ†® ÏÉÅÌÉúÏùò Í¥ÄÎ¶¨ÏôÄ ÏöîÏ≤≠ Ï≤òÎ¶¨ Ï†Ñ/ÌõÑÎ°ú Ïã§ÌñâÌï† ÏûëÏóÖÏùÑ ÏâΩÍ≤å ÏÑ§Ï†ïÌï† Ïàò ÏûàÏùå
- Ï≤´ Î≤àÏ®∞ Ïù∏Ïûê üëâ `Promise`Î•º Î∞òÌôòÌïòÎäî Ìï®Ïàò
- Îëê Î≤àÏß∏ Ïù∏Ïûê üëâ **_Ïù¥ ÏûëÏóÖÏù¥ Ï≤òÎ¶¨ÎêòÍ∏∞ Ï†ÑÌõÑÎ°ú Ïã§ÌñâÌï† Ìï®ÏàòÎ•º ÎÑ£Ïùå_**(ÏÉùÎûµÍ∞ÄÎä•)
  > - onMutate üëâ ÏöîÏ≤≠ ÏßÅÏ†Ñ Ï≤òÎ¶¨, Ïó¨Í∏∞ÏÑú Î∞òÌôòÌïòÎäî Í∞íÏùÄ ÌïòÎã® Ìï®ÏàòÎì§Ïùò contextÎ°ú ÏÇ¨Ïö©
  > - onError üëâ Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïù¥ Ïã§Ìå®ÌïòÍ≥† ÎÇòÏÑú ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥† Ïã∂ÏùÑ Îïå ÏÇ¨Ïö©
  > - onSuccess üëâ Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïù¥ ÏÑ±Í≥µÌïòÍ≥† ÎÇòÏÑú ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÍ≥† Ïã∂ÏùÑ Îïå ÏÇ¨Ïö©
  > - onSettled üëâ Îç∞Ïù¥ÌÑ∞ ÏöîÏ≤≠Ïùò ÏÑ±Í≥µ Ïó¨Î∂ÄÏôÄ Í¥ÄÍ≥ÑÏóÜÏù¥ ÏöîÏ≤≠Ïù¥ ÎÅùÎÇòÎ©¥ ÌäπÏ†ï Ìï®ÏàòÎ•º Ìò∏Ï∂úÌïòÎèÑÎ°ù ÏÑ§Ï†ï
- `return` Í∞í üëâ `useQuery` ÏôÄ ÎèôÏùº
  - `mutate` üëá
    > - ÏöîÏ≤≠ÏùÑ ÏãúÏûëÌïòÎäî Ìï®Ïàò
    > - Ï≤´ Î≤àÏß∏ Ïù∏Ïûê üëâ API Ìï®ÏàòÏóêÏÑú ÏÇ¨Ïö©Ìï† Ïù∏Ïûê
    > - Îëê Î≤àÏ®∞ Ïù∏Ïûê
    > - {onSuccess, onSettled, onError} Í∞ùÏ≤¥, (ÏÉùÎûµÍ∞ÄÎä•)
    > - option Ïóê ÏÑ§Ï†ïÎêú Ìï®ÏàòÍ∞Ä Î®ºÏ†Ä Ìò∏Ï∂úÎêòÍ≥†, mutate Îëê Î≤àÏß∏ ÌååÎùºÎØ∏ÌÑ∞Ïóê ÎÑ£ÏùÄ Ìï®ÏàòÍ∞Ä Ìò∏Ï∂úÎê®
  - `mutateAsync` üëâ `mutate`ÏôÄ Ïù∏ÏûêÎäî ÎèôÏùº, Ìï®ÏàòÎ•º Ìò∏Ï∂úÌñàÏùÑ Îïå Î∞òÌôò Í∞íÏù¥ `Primse`
  - `staus` üëâ ÏöîÏ≤≠ ÏÉÅÌÉúÎ•º Î¨∏ÏûêÏó¥Î°ú Î≥ÄÌôò(idle, loading, error, success)
  - `error` üëâ Ïò§Î•ò Ï†ïÎ≥¥
  - `data` üëâ ÏöîÏ≤≠ ÏÑ±Í≥µ Ïãú Îç∞Ïù¥ÌÑ∞Í∞Ä Îã¥Í≤®ÏûàÏùå
  - `reset` üëâ **_ÏÉÅÌÉúÎ•º Î™®Îëê Ï¥àÍ∏∞ÌôîÌïòÎäî Ìï®Ïàò_**

> **_ÏòàÏ†ú üëá_** `useMutation` ÏÇ¨Ïö©
>
> >

```javascript
const Index = () => {
  const [id, setId] = useState('');
  const [password, setPassword] = useState('');

  const loginMutation = useMutation(loginApi, {
    // variable -> {loginId: xxx, password: xxx}
    onMutate: variable => {
      console.log("onMutate", variable);
    },
    onError: (error, variable, context) => {
      // TODO: Error Ìï∏Îì§ÎßÅ
    },
    onSuccess: (data, variables, context) => {
      console.log("success", data, varibles, context);
    },
    onSettled: () => {
      console.log('end);
    },
  });

  function onSubmit() {
    // API Ìò∏Ï∂úÏóê ÏÇ¨Ïö©Îê† Ïù∏Ïûê
    loginMutation.mutate({loginId: id, password: password});
  }
}
```

> **_ÏòàÏ†ú üëá_** `invalidateQueries`Î•º ÏÇ¨Ïö©ÌïòÏó¨ UPDATE ÌõÑ GET Ìï®ÏàòÎ•º Í∞ÑÎã®ÌïòÍ≤å Ïã§Ìñâ
> `mutation` Ìï®ÏàòÍ∞Ä ÏÑ±Í≥µÌï† Îïå, `unique key`Î°ú ÎßµÌïëÎêú `GET`Ìï®ÏàòÎ•º `invalidateQueries`Ïóê ÎÑ£Ïñ¥Ï£ºÎ©¥ Îê®
> **_ÎßåÏïΩ `mutation`ÏóêÏÑú `return`Îêú Í∞íÏùÑ Ïù¥Ïö©Ìï¥ÏÑú `GET`Ìï®ÏàòÏùò ÌååÎùºÎØ∏ÌÑ∞Î•º Î≥ÄÍ≤ΩÌï¥Ïïº Ìï† Í≤ΩÏö∞ `setQueryData`Î•º ÏÇ¨Ïö©_**
>
> >

```javascript
const mutation = useMutation(postTodo, {
  onSuccess: () => {
    // postTodo Í∞Ä ÏÑ±Í≥µÌïòÎ©¥ todos Î°ú ÎßµÌïëÎêú useQuery API Ìï®ÏàòÎ•º Ïã§Ìñâ
    queryClient.invalidateQueries("todos");
  },
});

// ÎßåÏïΩ mutationÏóêÏÑú returnÎêú Í∞íÏùÑ Ïù¥Ïö©Ìï¥ÏÑú GET Ìï®ÏàòÏùò ÌååÎùºÎØ∏ÌÑ∞Î•º Î≥ÄÍ≤ΩÌï¥ÏïºÌï† Í≤ΩÏö∞ setQueryDataÎ•º ÏÇ¨Ïö©
const queryClient = useQueryClient();

// data Í∞Ä fetchTodoById Î°ú Îì§Ïñ¥Í∞ê
const mutation = useMutation(editTodo, {
  onSuccess: (data) => {
    queryClient.setQueryData(["todo", { id: 5 }], data);
  },
});

const { status, data, error } = useQuery(["todo", { id: 5 }], fetchTodoById);

mutation.mutate({
  id: 5,
  name: "nkh",
});
```
