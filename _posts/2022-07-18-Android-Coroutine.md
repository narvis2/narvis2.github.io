---
title: Android Coroutine
author: Narvis2
date: 2022-07-18 15:12:00 +0900
categories: [Android, Coroutine]
tags: [android, coroutine]
---

ì•ˆë…•í•˜ì„¸ìš”. Narvis2 ì…ë‹ˆë‹¤.  
ì´ë²ˆì‹œê°„ì—ëŠ” Kotlin `Coroutines Flow`ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ê¸° ì „ `Coroutine`ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ê³ ì í•©ë‹ˆë‹¤.  
ìš°ì„  `Coroutine`ì— ëŒ€í•˜ì—¬ ì•Œê¸°ì „ì— `ë™ê¸°`, `ë¹„ë™ê¸°`ì— ëŒ€í•˜ì—¬ ì•„ì…”ì•¼í•©ë‹ˆë‹¤.  
ê°„ë‹¨í•˜ê²Œ ì„¤ëª… ë“œë¦¬ë©´  
**_ë™ê¸°_** ğŸ‘‰ ìˆœì°¨ì ìœ¼ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ëª¨ë¸( **_ì–´ë–¤ ì‘ì—…ì´ ì²˜ë¦¬ ì¤‘ì´ë©´ ë‹¤ìŒ ì‘ì—…ì€ ëŒ€ê¸°_** )ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.  
**_ë¹„ë™ê¸°_** ğŸ‘‰ ë³‘ë ¬ì ìœ¼ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•˜ë©°, **_ì–´ë–¤ ì‘ì—…ì„ ì²˜ë¦¬ì¤‘ ì´ë”ë¼ë„ ì²˜ë¦¬ ë ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ì¦‰ì‹œ ë‹¤ìŒ ì‘ì—…ì„ ì²˜ë¦¬_** í•©ë‹ˆë‹¤.(ì‘ì—…ì´ ì¢…ë£Œë˜ëŠ” ì‹œì ì— ì²˜ë¦¬ ê²°ê³¼ë¥¼ ë°›ìŠµë‹ˆë‹¤.)
ì´ì œ `Coroutine`ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## ğŸ€ Coroutine

---

- ë¹„ë™ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì…ë‹ˆë‹¤.
- ê²½ëŸ‰ `Thread` : `Thread`ê°„ `Context` ì „í™˜ ë¹„ìš©ì´ ë°œìƒí•˜ì§€ ì•Šìœ¼ë©°, ê°œë°œìê°€ ì§ì ‘ ì¤‘ì§€ ì‹œì ì„ ì„ íƒ ê°€ëŠ¥í•˜ê³  `Thread`ë¥¼ **_ì¬ì‚¬ìš©_** ê°€ëŠ¥í•©ë‹ˆë‹¤.
  > **_âœ… ì°¸ê³ _**
  >
  > - `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì— í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ `Coroutine` ì€ ì ì‹œ ì¤‘ë‹¨ë˜ë©°, ê·¸ ë•Œ ë‚¨ê²Œë˜ëŠ” `Thread`ëŠ” ë‹¤ë¥¸ `Coroutine`ì— í• ë‹¹ë  ìˆ˜ ìˆìœ¼ë©° `suspend` í•¨ìˆ˜ì˜ ë¡œì§ì´ ëë‚¬ì„ ë•Œì— ì¤‘ë‹¨ë˜ì—ˆë˜ `Coroutine`ì€ ë‹¤ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤.
  > - âœ… ì¦‰, ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ì„œ ì¤‘ì§€ ìƒíƒœì¼ ë•Œ `Thread`ë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•Šê³  ê·¸ `Thread`ë¥¼ ì¬ì‚¬ìš©
- íŠ¹ì§• : `CoroutinScope` `Context`ì˜ `launch` ë¹Œë”ë¥¼ í†µí•˜ì—¬ ì‹¤í–‰ë  ìˆ˜ ìˆìœ¼ë©°, ì´ ë¹Œë” ë¸”ë¡ì•ˆì˜ ì½”ë“œëŠ” `Thread`ì²˜ëŸ¼ **_ë¹„ë™ê¸°ë¡œ ì‹¤í–‰_** ë©ë‹ˆë‹¤.
- `Coroutine`ì€ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ì„œ **_ì¤‘ì§€ ìƒíƒœì¼ ë•Œ `Thread`ë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•Šê³  ê·¸ `Thread`ë¥¼ ì¬ì‚¬ìš©_** í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë”ìš± íš¨ìœ¨ì ì´ê³  ë¹ ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ€ suspend point

---

- `Coroutine` ì„ ì‚¬ìš©í•˜ì‹œë ¤ë©´ `suspend` í•¨ìˆ˜ì— ëŒ€í•˜ì—¬ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.
- **_í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ì‘ì—…ì„ ì¤‘ì§€í•˜ê³  ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰ì‹œí‚¤ëŠ”_** í•¨ìˆ˜ ì…ë‹ˆë‹¤.
- `Coroutine`ì´ ì‚¬ìš©ì¤‘ì¸ `Thread`ë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•Šìœ¼ë©´ì„œ ì‹¤í–‰ì¤‘ì¸ `Coroutine`ì„ ì ì‹œ ì¤‘ë‹¨ ì‹œí‚¬ ìˆ˜ ìˆëŠ” **_ì¤‘ë‹¨ ì§€ì  í•¨ìˆ˜_** ì…ë‹ˆë‹¤.
- `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹œì ì— í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ `Coroutine` ì€ ì ì‹œ ì¤‘ë‹¨ë˜ë©°, ê·¸ ë•Œ ë‚¨ê²Œë˜ëŠ” `Thread`ëŠ” ë‹¤ë¥¸ `Coroutine`ì— í• ë‹¹ë  ìˆ˜ ìˆìœ¼ë©° `suspend` í•¨ìˆ˜ì˜ ë¡œì§ì´ ëë‚¬ì„ ë•Œì— ì¤‘ë‹¨ë˜ì—ˆë˜ `Coroutine`ì€ ë‹¤ì‹œ ì‹¤í–‰ë©ë‹ˆë‹¤.
- **_`suspend` í•¨ìˆ˜ëŠ” `Coroutine` ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ê±°ë‚˜ `suspend` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼_** í•©ë‹ˆë‹¤. `suspend` í•¨ìˆ˜ í˜¸ì¶œ ë˜í•œ ë‹¤ë¥¸ `Coroutine`ì—ì„œ ì¼ì–´ë‚˜ê±°ë‚˜ `suspend`í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

  > âœ… ì¦‰, **`suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ìµœì†Œ í•˜ë‚˜ì˜ `Coroutine Builder` ë¸”ë¡ì´ í•„ìš”í•˜ê²Œ ë©ë‹ˆë‹¤.**

  > **_ì˜ˆì œ_** ) ê°„ë‹¨í•œ ì½”ë“œë¥¼ í†µí•´ ì•Œì•„ë³´ê¸° ğŸ‘‡

  ```kotlin
      runBlocking {
          launch { uniFuction() }
      }

      suspend fun somNetworkCall(): String {
          delay(1000)
          return "data from network"
      }

      suspend fun uniFuction() {
          val data = somNetworkCall()
          println(data)
          println("uniFuction is done")
      }
  ```

  > **_ê²°ê³¼_** ğŸ‘‡
  >
  > - "data from network"
  > - "uniFuction is done"

  > - ğŸ‘ í•´ì„¤ : `uniFuction()` í•¨ìˆ˜ë¥¼ `Coroutine`ìœ¼ë¡œ í˜¸ì¶œí•˜ê²Œ ë˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ `somNetworkCall()` í˜¸ì¶œì´ ì¼ì–´ë‚˜ê²Œ ë˜ê³ , **_ì´ ì§€ì ì—ì„œ ì‹¤í–‰ë˜ê³  ìˆë˜ `unifuction()` í•¨ìˆ˜ëŠ” `someNetworkCall()` í•¨ìˆ˜ì˜ í˜¸ì¶œì´ ëë‚  ë•Œ ê¹Œì§€ ëŒ€ê¸°í•˜ë‹¤ê°€ `somNetwork()` í•¨ìˆ˜ í˜¸ì¶œì´ ëë‚˜ë©´ ë‹¤ì‹œ ì‹¤í–‰_** ë©ë‹ˆë‹¤.
  > - âœ… ì¦‰, `uiFuction()`ì„ ì‹¤í–‰í•˜ê³  ìˆëŠ” `Thread`ëŠ” **_ëŒ€ê¸°í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë‹¤ë¥¸ `Coroutine`ì— í• ë‹¹ë  ìˆ˜ ìˆëŠ” ìƒíƒœ_** ê°€ ëœë‹¤.

## ğŸ€ Coroutine Scope

---

### â˜˜ï¸ 1. GlobalScope

- ì•±ì˜ **_ì‹œì‘ë¶€í„° ì¢…ë£Œê¹Œì§€_** ì¥ì‹œê°„ ì‹¤í–‰ë˜ì–´ì•¼ í•  í•„ìš”ê°€ ìˆì„ ê²½ìš° ì‚¬ìš©í•©ë‹ˆë‹¤.
- **_`Application`ì˜ `Lifecycle`ê³¼ í•¨ê»˜ ë™ì‘_** í•©ë‹ˆë‹¤.(ì•±ì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆì—ëŠ” ë³„ë„ì˜ ìƒëª…ì£¼ê¸°ê°€ í•„ìš”ì—†ìŠµë‹ˆë‹¤.) ì¦‰, **_ì•± `Process`ì˜ `Lifecycle`ì„ ë”°ë¼ê°‘ë‹ˆë‹¤._**

### â˜˜ï¸ 2. CoroutineScope

- **_ì‘ì—… í•„ìš”í•  ë•Œë§Œ ì‹¤í–‰í•˜ê³  ì™„ë£Œë˜ë©´ ì¢…ë£Œ_** ë©ë‹ˆë‹¤.
- `Coroutine`ì˜ ê¸°ë³¸ `Scope`ë¡œ ë‹¤ë¥¸ `Scope`ëŠ” `Coroutine Scope`ë¥¼ ìƒì† ë°›ì•„ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.
  > âœ… **ì°¸ê³ ** : **_ì£¼ë¡œ ë²„íŠ¼ì„ í´ë¦­í•´ì„œ ì„œë²„ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ íŒŒì¼ì„ ì—´ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.

### â˜˜ï¸ 3. MainScope

- **_UI ê´€ë ¨ ì‘ì—…_** ì„ ì²˜ë¦¬í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì´ `Scope` ì•ˆì—ì„œ ë§Œë“¤ì–´ì§„ ëª¨ë“  `Coroutine` ì„ **_`Main Thread`ì—ì„œ ì‹¤í–‰_** í•©ë‹ˆë‹¤.

### â˜˜ï¸ 4. coroutineScope (ì†Œë¬¸ì)

- ë°˜í™˜ì „ì— ì œê³µë˜ëŠ” ìì‹ ë²”ìœ„ ë‚´ì˜ ëª¨ë“  ì‘ì—…ì˜ ì™„ë£Œë¥¼ ë³´ì¥í•©ë‹ˆë‹¤.
- êµ¬ì¡°í™”ëœ ë™ê¸°ì„±, **_`suspend` í•¨ìˆ˜ê°€ ë°˜í™˜ë˜ê¸° ì „ì— ìì‹ ë²”ìœ„ ë‚´ì—ì„œ `Coroutine`ì— ì˜í•´ ì‹œì‘ëœ ëª¨ë“  ì‘ì—…ì„ ì™„ë£Œí•˜ë„ë¡ ë³´ì¥_** í•©ë‹ˆë‹¤. ì¦‰, `coroutineScope` ë¸”ë¡ì•ˆì˜ `suspend` í•¨ìˆ˜ê°€ ì™„ë£Œ ë˜ë©´ ë°˜í™˜í•©ë‹ˆë‹¤.

### â˜˜ï¸ 5. viewModelScope

- `ViewModel` ì— ì—°ê²°ëœ `Coroutine Scope` ì…ë‹ˆë‹¤.
- `ViewModel`ì´ í™œì„±í™”ëœ ìƒíƒœì¸ ê²½ìš°ì—ë§Œ ì‹¤í–‰í•´ì•¼ í•  ì‘ì—…ì´ ìˆì„ ê²½ìš° ì‚¬ìš©í•©ë‹ˆë‹¤.
- ì´ ë²”ìœ„ì—ì„œ ì‹œì‘ë˜ëŠ” ëª¨ë“  `Coroutine`ì€ **_`ViewModel` ì´ ì‚­ì œë˜ë©´ ìë™ìœ¼ë¡œ ì·¨ì†Œ_** ë©ë‹ˆë‹¤.(`onCleared()`ê°€ í˜¸ì¶œë˜ë©´ ìë™ìœ¼ë¡œ ì·¨ì†Œë¨) ì¦‰, **_ìˆ˜ë™ìœ¼ë¡œ `onCleared()`ì—ì„œ `Job Cancel`ì„ í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤._**

### â˜˜ï¸ 6. lifecycleScope

- `Activity/Fragment` ì˜ `lifecycle` ì— ì—°ê²°ëœ `Coroutine Scope` ì…ë‹ˆë‹¤.
- ì´ ë²”ìœ„ì—ì„œ ì‹œì‘ëœ ëª¨ë“  `Coroutine` ì€ **_`Lifecycle`ì´ íŒŒê´´ë˜ë©´ ìë™ìœ¼ë¡œ ì·¨ì†Œ_** ë©ë‹ˆë‹¤.
- `Activity/Fragment` ì™€ ê°™ì€ **_ìˆ˜ëª…ì£¼ê¸°ê°€ ìˆëŠ” ê°ì²´ì— `Coroutine`ì„ ë§Œë“¤ ë•Œ_** ì‚¬ìš©í•©ë‹ˆë‹¤.

### â˜˜ï¸ 7. LiveData + Coroutine (LiveData Builder)

- `LiveData`ë¥¼ ì‚¬ìš©í•  ë•Œ ê°’ì„ **_ë¹„ë™ê¸°ì ìœ¼ë¡œ ê³„ì‚°í•´ì•¼ í•  ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.
- ì‚¬ìš©ìì˜ í™˜ê²½ ì„¤ì •ì„ ê²€ìƒ‰í•˜ì—¬ UIì— ì œê³µí•  ë•Œ ì´ëŸ° ê²½ìš° `liveData { }` ë¥¼ ì‚¬ìš©í•´ `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ê²°ê³¼ë¥¼ `LiveData` ê°ì²´ë¡œ ì œê³µ(`emit`) í•©ë‹ˆë‹¤.
- `emit()` ì„ í†µí•´ ê²°ê³¼ë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤.
- **_`LiveData`ê°€ í™œì„±í™”ë˜ë©´ ì‹¤í–‰ì„ ì‹œì‘í•˜ê³  `LiveData`ê°€ ë¹„í™œì„±í™”ê°€ ë˜ë©´ êµ¬ì„± ê°€ëŠ¥í•œ ì œí•œ ì‹œê°„ í›„ ìë™ìœ¼ë¡œ ì·¨ì†Œ ë©ë‹ˆë‹¤._**

  > ê°„ë‹¨í•œ ì½”ë“œë¥¼ í†µí•´ ì•Œì•„ë³´ê¸° ğŸ‘‡

  ```kotlin
  val isMobileDataOk: LiveData<Boolean> = liveData { // LiveData Builder ì…ë‹ˆë‹¤.
      dataStore.getUserMobileData.collect { // DataStoreì— ì €ì¥ëœ ê°’ ê°€ì ¸ì˜¤ê¸°
          emit(it) // ê²°ê³¼ë¥¼ LiveDataì— ë³´ë‚´ê¸°
      }
  }
  ```

## ğŸ€ Coroutine Builder

---

### â˜˜ï¸ 1. runBlocking

- í˜„ì¬ `Thread`ë¥¼ ë¸”ë¡í‚¹í•˜ëŠ” `Coroutine Builder` ì…ë‹ˆë‹¤.
  > **_âœ… ì°¸ê³ _**
  >
  > - ë¸”ë¡í‚¹ ğŸ‘‰ ì£¼ì–´ì§„ ë¸”ë¡ì´ ì™„ë£Œë ë•Œ ê¹Œì§€ í˜„ì¬ Threadë¥¼ ë©ˆì¶¤
- ì¼ë°˜ í•¨ìˆ˜ ë‚´ì—ì„œ `suspend` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°€ì¥ ë‹¨ìˆœí•œ í˜•íƒœì˜ `Coroutine Builder` ì…ë‹ˆë‹¤.
- ë‚´ë¶€ `suspend` í•¨ìˆ˜ë“¤ë„ **_ëª¨ë‘ í˜„ì¬ `Thread`ë¥¼ ë¸”ë¡œí‚¹_** í•˜ê²Œ ë©ë‹ˆë‹¤.
- ì£¼ë¡œ **_`Test`ì‹œ `Top Level` í•¨ìˆ˜ë¡œ ì‚¬ìš©_** ë˜ë©°, **_ì£¼ì–´ì§„ ë¸”ë¡ì´ ì™„ë£Œë ë•Œ ê¹Œì§€ í˜„ì¬ `Thread`ë¥¼ ë©ˆì¶”ëŠ” ìƒˆë¡œìš´ `Coroutine`ì„ ìƒì„±í•˜ì—¬ ì‹¤í–‰_** í•˜ëŠ” Coroutine Builder ì…ë‹ˆë‹¤.
- ì˜ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë‚˜ Test ì½”ë“œë¥¼ ì§¤ë•Œ ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.
  > **_â—ï¸ì£¼ì˜â—ï¸_**
  >
  > - **_ì‹¤ë¬´ì—ì„œëŠ” ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤._** ê·¸ ì´ìœ ëŠ” `Context`ê°€ `Main Thread`ì¼ ë•Œ `runBlocking` ì„ ë„£ìœ¼ë©´ ì˜¤ë¥˜ë¥¼ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  > - ì—¬ê¸°ì„œ ì˜¤ë¥˜ë€ `Main Thread`ë¥¼ **_ì¥ê¸°ê°„ ë¸”ëŸ­í‚¹_** í•˜ì—¬ `ANR` ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ **_`runBlocking` ì€ `Unit Test`ì—ì„œ ì£¼ë¡œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.

### â˜˜ï¸ 2. launch

- ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” `Coroutine Builder` ì…ë‹ˆë‹¤.
- í˜„ì¬ `Thread`ë¥¼ **_ë¸”ë¡í‚¹ í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ë¹„ë™ê¸° ì‘ì—…ì„ ì‹œì‘_** í•©ë‹ˆë‹¤.
- `Coroutine`ì´ ì‹œì‘ë˜ì—ˆë‹¤ëŠ” ì˜ë¯¸ì˜ **_`Job` ê°ì²´ë¥¼ ë°˜í™˜_** í•©ë‹ˆë‹¤.
  > - `Job` ê°ì²´ëŠ” `Coroutine`ì˜ **_ì¢…ë£Œë¥¼ ê¸°ë‹¤ë¦¬ê±°ë‚˜ ì·¨ì†Œë¥¼ ê¸°ë‹¤ë¦¬ê¸° ìœ„í•´ì„œ ì‚¬ìš©_** ë©ë‹ˆë‹¤.
- `Job` ì˜ `isCancelled` í”„ë¡œí¼í‹°ë¥¼ ì´ìš©í•˜ì—¬ ì‘ì—…ì´ ì„±ê³µì¸ì§€, ì‹¤íŒ¨ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **_ê²°ê³¼ ê°’ì„ ë°˜í™˜ë°›ì„ ìˆ˜ ì—†ê¸°_** ë•Œë¬¸ì— `íŒŒì´ì–´ ì•¤ë“œ í¬ì¼“` ë°©ì‹ì˜ `UseCase`ì—ì„œ ë§ì´ ì‚¬ìš©í•©ë‹ˆë‹¤.

  > **âš ï¸ì£¼ì˜âš ï¸**
  >
  > - **_ì˜ˆì™¸ê°€ ì „íŒŒë˜ì§€ ì•Šê¸° ë•Œë¬¸ì—_** ë¸”ë¡ ë‚´ë¶€ì—ì„œ `CoroutineExceptionHandler` ì™€ í•¨ê»˜ `try-catch` ê°€ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  > - `CoroutineExceptionHandler` ë¥¼ ì‚¬ìš©í•œ Sample Code ì…ë‹ˆë‹¤. ğŸ‘‡

  ```kotlin
  fun main() = runBlocking {
      val handler = CoroutineExceptionHandler { coroutineContext, throwable ->
          println("Caught:${coroutineContext[CoroutineName]}, ${throwable.message?.substring(0..28)}")
      }

      try {
          val airportCodes = listOf("LAX", "SF-", "PD-", "SEA")
          val jobs: List<Job> = airportCodes.map { onAirportCode ->
              // SupervisorJob -> ë‹¨ ë°©í–¥ ì·¨ì†Œê°€ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. (ë¶€ëª¨ì—ì„œ ìì‹ìœ¼ë¡œë§Œ ë‹¨ë°©í–¥ìœ¼ë¡œ ì·¨ì†Œê°€ ê°€ëŠ¥í•˜ê²Œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.)
              launch(Dispatchers.IO + CoroutineName(onAirportCode) + handler + SupervisorJob()) {
                  val airport = Airport.getAirportData(onAirportCode) // Network ìš”ì²­
                  println("${airport.code}")
              }
          }

          jobs.forEach { it.join() }
          jobs.forEach { println("cancelled : ${it.isCancelled}") }
      } catch (e:Exception) {
          println("ERROR: ${e.message}")
      }
  }
  ```

### â˜˜ï¸ 3. async

- í˜„ì¬ `Thread`ë¥¼ **_ë¸”ë¡í‚¹í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ ë¹„ë™ê¸° ì‘ì—…ì„ ì‹œì‘_** í•©ë‹ˆë‹¤.
- **_`Deferred<T>` íƒ€ì…ì˜ ê°ì²´ë¥¼ ë°˜í™˜_** í•˜ë©° `await()`ë¥¼ í˜¸ì¶œí•˜ì—¬ **_ê²°ê³¼ ê°’ì„ ë°˜í™˜ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤._**
- `await()`ëŠ” `susepnd` í•¨ìˆ˜ ì´ê¸°ì— `Coroutine` ë‚´ë¶€ë‚˜ ë˜ ë‹¤ë¥¸ `susepnd` í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í˜¸ì¶œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
  > **ì°¸ê³ ** ğŸ‘‰ **_ì˜ˆì™¸ê°€ ì „íŒŒë˜ê¸° ë•Œë¬¸ì—_** ë¸”ë¡ ì™¸ë¶€ì—ì„œ `try-catch` ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### â˜˜ï¸ 4. withContext

- í˜„ì¬ `Thread`ë¥¼ **_ë¸”ë¡í‚¹í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ `Coroutine`ì„ ì‹¤í–‰_** í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- `async` ì²˜ëŸ¼ **_ê²°ê³¼ê°’ì„ ë°˜í™˜í•˜ëŠ” ë¹Œë”_** ì…ë‹ˆë‹¤. `async`ëŠ” ë°˜í™˜í•˜ëŠ” `Deferred<T>` ê°ì²´ë¡œ ê²°ê³¼ê°’ì„ ì›í•˜ëŠ” ì‹œì ì— `await()`í•¨ìˆ˜ë¥¼ í†µí•´ ê²°ê³¼ê°’ì„ ì–»ì§€ë§Œ, `withContext()`ëŠ” `Deferred<T>`ê°ì²´ë¡œ ë°˜í™˜í•˜ì§€ ì•Šê³ , **_`ê²°ê³¼(T)`ë¥¼ ê·¸ ìë¦¬ì—ì„œ ë°˜ë‚©_** í•©ë‹ˆë‹¤.
- ì½”ë“œì˜ í•œ ë¶€ë¶„ì„ `Coroutine`ì˜ ë‹¤ë¥¸ ì½”ë“œë“¤ê³¼ ì™„ì „íˆ ë‹¤ë¥¸ `Context`ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.(`Coroutine`ì„ í•œ `Context`ì—ì„œ ì‹¤í–‰í•˜ë‹¤ê°€ **_ì¤‘ê°„ì— `Context`ë¥¼ ë°”ê¾¸ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.)

## ğŸ€ Coroutine Context

---

### â˜˜ï¸ 1. Dispatchers.Default

- `Coroutine`ì—ê²Œ `DefaultDispatchers` í’€(`pool`)ì˜ `Thread` ì•ˆì—ì„œ ì‹¤í–‰ì„ ì‹œì‘í•˜ë¼ê³  ì§€ì‹œí•©ë‹ˆë‹¤.
- í’€(`Pool`) ì•ˆì˜ `Thread` ìˆ«ìëŠ” `2`ê°œ ì´ê±°ë‚˜ **_ì‹œìŠ¤í…œì˜ ì½”ì–´ ìˆ«ì ì¤‘ ë†’ì€ ê²ƒ_** ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **_ê³„ì‚°í•œ ì¼ì´ ë§ì€ ì‘ì—…ì„ ìœ„í•œ í’€(`Pool`)_** ì…ë‹ˆë‹¤. (`cpu` ì—ì„œ ì²˜ë¦¬í•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ ì‘ì—…ë“¤ì— ì‚¬ìš©í•©ë‹ˆë‹¤.)
  > **ì°¸ê³ ** ğŸ‘‰ `ë°ì´í„° ì²˜ë¦¬`, `ì´ë¯¸ì§€ ì²˜ë¦¬` ë“±ì— ì‚¬ìš©í•©ë‹ˆë‹¤.

### â˜˜ï¸ 2. Dispatchers.IO

- `IO` ì‘ì—… ì‹¤í–‰ì„ ìœ„í•œ í’€(`Pool`)ì•ˆì— `Coroutine`ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
- **_`Local`, `Network` ì—ì„œ ë°ì´í„°ë¥¼ ì½ì„ ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.
  > **ì°¸ê³ ** ğŸ‘‰ `ë„¤íŠ¸ì›Œí¬ ì‘ì—…`, `ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ`, `íŒŒì¼ ì…ì¶œë ¥` ë“±ì˜ **_ì…ì¶œë ¥ì— ìµœì í™” ë˜ì–´_** ìˆìŠµë‹ˆë‹¤.
  >
  > **_â—ï¸ì£¼ì˜â—ï¸_** ğŸ‘‰ `IO`ì—ì„œ `UI` ë³€ê²½ ì‹œ `IOException` ì´ ë°œìƒ í•˜ë¯€ë¡œ **_`UI` ë³€ê²½ì€ `Main Thread`ì—ì„œë§Œ_** í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.

### â˜˜ï¸ 3. Dispatchers.Main

- `Main Thread` ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” **_`UI` ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ì´ í•„ìš”í•  ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.
- `Android Main Thread UI` ì‘ì—…ì— ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
  > **ì°¸ê³ ** ğŸ‘‰ í•­ìƒ **_`Main Thread`ë¡œ `Coroutine`ì„ ì‹œì‘í•œ ë‹¤ìŒ `Background Thread`ë¡œ ì „í™˜í•˜ëŠ” ê²ƒ_** ì´ ì¢‹ìŠµë‹ˆë‹¤.

### â˜˜ï¸ 4. Custom Pool ì—ì„œ ì‹¤í–‰ ì‹œí‚¤ê¸°

- í’€(`Pool`)ì•ˆì— `Thread`ê°€ ìˆê¸° ë•Œë¬¸ì— ì´ `Context`ë¥¼ ì‚¬ìš©í•˜ëŠ” `Coroutine`ì€ **_ë³‘ë ¬_** ì§„í–‰ì´ ì•„ë‹Œ **_ë™ì‹œ_** ì§„í–‰ìœ¼ë¡œ ì§„í–‰ë©ë‹ˆë‹¤.
- ì‘ì—…ì„ `Coroutine`ìœ¼ë¡œ ì§„í–‰ì‹œí‚¬ ë•Œ **_ì‘ì—…ë“¤ ê°„ì— ìì› ê²½ìŸì— ëŒ€í•´ì„œ ê³ ë ¤í•  ë•Œ ì‚¬ìš©_** í•©ë‹ˆë‹¤.

  > **_ì˜ˆì œ_** ) `Single Thread` ìƒì„±ì ë§Œë“¤ê¸° ğŸ‘‡

  ```kotlin
  Executors.newSingleThreadExecutor()
  ```

  > - ì‹¤í–‰ìë¡œ ë¶€í„° `CoroutineContext` ê°€ì ¸ì˜¤ê¸° ğŸ‘‡ (`.asCoroutineDispatcher()` í™•ì¥í•¨ìˆ˜ ì‚¬ìš©)

  ```kotlin
  Executors.newSingleThreadExecutor().asCoroutineDispatcher().use { context ->
      runBlocking {
          // launch ì— contextë¥¼ ì „ë‹¬í•˜ë©´ í•´ë‹¹ ë¸”ëŸ­ì—ì„œ ì‹¤í–‰ë˜ëŠ” Coroutineì€ Single Thread Poolì—ì„œ ë™ì‘í•©ë‹ˆë‹¤.
          launch(context) {
              // TODO: Coroutine ì—ì„œ ì‹¤í–‰í•  í•¨ìˆ˜ ë° ë™ì‘
          }
      }
  }
  ```

  > **_â—ï¸ì£¼ì˜â—ï¸_**
  >
  > - **_ì‹¤í–‰ìë¥¼ ë‹«ì§€ ì•Šìœ¼ë©´ í”„ë¡œê·¸ë¨ì´ ì˜ì›íˆ ë©ˆì¶”ì§€ ì•ŠìŠµë‹ˆë‹¤._** ê·¸ ì´ìœ ëŠ” ì‹¤í–‰ìì˜ í’€(`Pool`)ì—ëŠ” `Main Thread` ì™¸ì—ë„ `Active Thraed`ê°€ ìˆê³ , **_`Active Thread`ê°€ `JVM` ì„ ê³„ì† ì‚´ë ¤ë‘ê²Œ ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤._**

  > **_âœ… í•´ê²°_**
  >
  > - ìœ„ì˜ ìƒí™©ì„ í•´ê²°í•˜ê¸° ìœ„í•´ `.use{context -> }`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

  > **_ì˜ˆì œ_** ğŸ‘‡
  >
  > - ë‹¤ìŒì€ `Multi Thread` ë¥¼ ê°€ì§€ëŠ” í’€(`Pool`) ì‚¬ìš© ì½”ë“œ ì…ë‹ˆë‹¤.
  > - ì¦‰ **_ì‹œìŠ¤í…œ ì½”ì–´ì˜ ìˆ«ì ë§Œí¼ `Thread`ë¥¼ ì´ìš©í•˜ê³  ì‹¶ì„ ë•Œ_** ì‚¬ìš©í•©ë‹ˆë‹¤.

  ```kotlin
  Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors())
              .asCoroutineDispatcher().use { context ->
                  runBlocking {
                      launch(context) {
                          // TODO: Coroutine ì—ì„œ ì‹¤í–‰í•  í•¨ìˆ˜ ë° ë™ì‘
                      }
                  }
              }
  ```

  > **âœ… ì°¸ê³ ** ğŸ‘‰ ì´ `context`ë¥¼ ì‚¬ìš©í•˜ëŠ” `Coroutine`ì€ **_ì½”ë“œê°€ ë™ì‘í•˜ëŠ” ì‹œìŠ¤í…œì˜ ì½”ì–´ ìˆ«ìì™€ ë™ì¼í•œ `Thread` ìˆ«ìë¥¼ ê°€ì§€ëŠ” `ì»¤ìŠ¤í…€ Pool`ì—ì„œ ì‹¤í–‰_** ë©ë‹ˆë‹¤.

## ğŸ€ Mutex (ìƒí˜¸ë°°ì œ)

- ìƒí˜¸ ë°°ì œ ğŸ‘‰ **_í•œë²ˆì— í•˜ë‚˜_** ì˜ `Coroutine`ë§Œ **_ì½”ë“œ ë¸”ëŸ­ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡_** í•˜ëŠ” **_ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜_** ì…ë‹ˆë‹¤.
  > - âœ… ì¦‰, ëª¨ë“  ê³µìœ ë˜ëŠ” **_ìƒíƒœì˜ ë³€ê²½ë“¤ì´ ì ˆëŒ€ ë™ì‹œ ì‹¤í–‰ë˜ì§€ ì•Šë„ë¡_** í•©ë‹ˆë‹¤.
- **_ë™ì‹œì— ì‹¤í–‰ë˜ë©´ ì•ˆë˜ëŠ” ë¶€ë¶„_** ì„ `lock()/unlock()` ìœ¼ë¡œ ë³´í˜¸í•©ë‹ˆë‹¤. (**_Listì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ë¶€ë¶„ì— ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤._**)
- í•´ë‹¹ `Thread`ëŠ” **_`Block`ì˜ ì‘ì—…ì´ ë‹¤ ì²˜ë¦¬ë  ë•Œ ê¹Œì§€ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤._** (ì°¨ë‹¨ ì—­í• )
  > **_ì˜ˆì œ_** ğŸ‘‡
  ```kotlin
  private val mutex = Mutex()
  private suspend fun test() {
      mutex.withLock {
          // TODO: something..
      }
  }
  ```

## ğŸ€ ë§ˆë¬´ë¦¬

---

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” `Coroutine`ì˜ ê¸°ë³¸ ê°œë…ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. `Coroutine`ì„ ì‚¬ìš©í•˜ë©´ **_ë§¤ìš° ê°„ê²°í•˜ê²Œ ë¹„ë™ê¸° ì²˜ë¦¬_** ê°€ ë©ë‹ˆë‹¤.  
`Coroutine` ì€ **_ê²½ëŸ‰ Threadë¡œ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©´ì„œ ì¤‘ì§€ ìƒíƒœì¼ ë•Œ Threadë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•Šê³  ê·¸ Threadë¥¼ ì¬ì‚¬ìš©_** í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë”ìš± íš¨ìœ¨ì ì´ê³  ë¹ ë¥´ê²Œ ë™ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ë‹¤ìŒ í¬ìŠ¤íŒ…ì—ì„œëŠ” `Coroutine Flow`ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.
