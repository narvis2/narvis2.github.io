<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Android Naver Open API 영화 검색 어플" /><meta name="author" content="Narvis2" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="안녕하세요. Narvis2 입니다. 이번 포스팅에서는 “Naver Open API를 이용한 영화 검색” 어플에 사용된 기술과 프로젝트에 대하여 알아보겠습니다. 재직중인 회사에서 사용하는 기술을 과제의 주제에 벗어나지 않는 선에서 모두 보여드리고 노력하였습니다. 해당 프로젝트 전체 코드 👉🏿 Naver Open API를 이용한 영화 검색 어플" /><meta property="og:description" content="안녕하세요. Narvis2 입니다. 이번 포스팅에서는 “Naver Open API를 이용한 영화 검색” 어플에 사용된 기술과 프로젝트에 대하여 알아보겠습니다. 재직중인 회사에서 사용하는 기술을 과제의 주제에 벗어나지 않는 선에서 모두 보여드리고 노력하였습니다. 해당 프로젝트 전체 코드 👉🏿 Naver Open API를 이용한 영화 검색 어플" /><link rel="canonical" href="https://narvis2.github.io/posts/Android-Clean-Architecture/" /><meta property="og:url" content="https://narvis2.github.io/posts/Android-Clean-Architecture/" /><meta property="og:site_name" content="Narvis2" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-21T11:11:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Android Naver Open API 영화 검색 어플" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Narvis2"},"dateModified":"2022-07-22T11:33:01+09:00","datePublished":"2022-07-21T11:11:00+09:00","description":"안녕하세요. Narvis2 입니다. 이번 포스팅에서는 “Naver Open API를 이용한 영화 검색” 어플에 사용된 기술과 프로젝트에 대하여 알아보겠습니다. 재직중인 회사에서 사용하는 기술을 과제의 주제에 벗어나지 않는 선에서 모두 보여드리고 노력하였습니다. 해당 프로젝트 전체 코드 👉🏿 Naver Open API를 이용한 영화 검색 어플","headline":"Android Naver Open API 영화 검색 어플","mainEntityOfPage":{"@type":"WebPage","@id":"https://narvis2.github.io/posts/Android-Clean-Architecture/"},"url":"https://narvis2.github.io/posts/Android-Clean-Architecture/"}</script><title>Android Naver Open API 영화 검색 어플 | Narvis2</title><link rel="android-chrome-192x192" sizes="192x192" href="/assets/img/favicons/android-chrome-192x192.png"><link rel="android-chrome-512x512" sizes="512x512" href="/assets/img/favicons/android-chrome-512x512.png"><link rel="mstile-150x150" sizes="150x150" href="/assets/img/favicons/mstile-150x150.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Narvis2"><meta name="application-name" content="Narvis2"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/main.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Narvis2</a></div><div class="site-subtitle font-italic">개발 일지</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/narvis2" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['narvis2','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>Android Naver Open API 영화 검색 어플</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Android Naver Open API 영화 검색 어플</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1658369460" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-07-21 </em> </span> <span> 업데이트 <em class="" data-ts="1658457181" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-07-22 </em> </span><div class="d-flex justify-content-between"> <span> By <em> narvis2 </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6837 단어"> <em>37 분</em>읽는 시간</span></div></div></div><div class="post-content"><p>안녕하세요. Narvis2 입니다.<br /> 이번 포스팅에서는 <strong><em>“Naver Open API를 이용한 영화 검색”</em></strong> 어플에 사용된 기술과 프로젝트에 대하여 알아보겠습니다.</p><p>재직중인 회사에서 사용하는 기술을 과제의 주제에 벗어나지 않는 선에서 모두 보여드리고 노력하였습니다.</p><p>해당 프로젝트 전체 코드 👉🏿 <a href="https://github.com/narvis2/MovieSearchApp">Naver Open API를 이용한 영화 검색 어플</a></p><h2 id="앱-기능"><span class="mr-2">앱 기능</span><a href="#앱-기능" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><ol><li>Naver Open API를 사용하여 원하는 영화를 검색합니다.<li>검색한 내용을 RecyclerView를 통해 보여주며 Paging3를 사용하여 Page에 따라 list를 추가로 불러와 보여줍니다.<blockquote><p><strong><em>참고</em></strong> : 해당 포스팅에 Paging3에 관하여 자세히 정리 했습니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-Paging3/">Paging3에 대하여</a></p></blockquote><li>RecyclerView에 썸네일 이미지, 제목, 평점, 연도, 감독, 출연 배우를 표기하고 Item Click 시 해당 API Response에 있는 link를 바탕으로 WebView를 띄워줍니다.<blockquote><p><strong><em>참고</em></strong> : 해당 프로젝트에서는 Image Load를 위해 Glide를 사용합니다. 다음은 Glide 관련 포스팅입니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-Glide/">Glide Image 처리</a></p></blockquote><li>해당 어플은 Network가 끊겼을 때 할 수 있는 동작이 없기 때문에 ConnectivityManager를 통해 Network Callback을 받아 네트워크가 끊겼을 때 네트워크가 끊겼다는 화면을 보여줍니다. 네트워크가 연결되면 자동으로 해당 화면이 사라지고 어플을 계속 컨트롤 할 수 있습니다.<blockquote><p><strong><em>참고</em></strong> : 해당 포스팅에 ConnectivityManager를 통한 Netwrok 관리에 관하여 자세히 정리 했습니다.<br /> 👉🏿 <a href="https://narvis2.github.io/posts/Android-Network/">Netwrok 관리</a></p></blockquote><li>프로젝트의 패턴은 Claen Architecture MVVM 을 채택하였습니다.<li>AAC ViewModel 을 사용하여 앱 구성요소 변경에도 앱의 데이터와 내용이 사라지지 않게 설계하였습니다.<li>Single Activity를 적용하였습니다.<blockquote><p>Jetpack Navigation을 통해 Single Activity를 적용하였으며, 이렇게한 이유 역시 재직중인 회사에서 사용하는 기술을 과제의 주제에 벗어나지 않는 선에서 모두 보여드리고자 선택하였습니다.<br /> 🚩<strong><em>참고</em></strong>🚩 Single Activity의 장단점</p><ul><li>1️⃣ 장점 : Activity Stack에 Activity를 쌓아두기 보다. Fragment BackStack에서 Fragment를 관리하는 것이 메모리 관리에서의 효율도 챙기고 화면 전환시 Activity 보다 순조롭습니다.<li>2️⃣ 장점 : 데이터 공유에 있어 이점이 있습니다. Activity간 Data를 전달하려면 Intent를 통해 직렬화/역직렬화를 과정을 거쳐야 하며, 이는 메모리 공유에 비해 결코 가벼운 작업이 아닙니다.<li>3️⃣ 장점 : 재사용성이 증가합니다. View 나 Business Logic을 Fragment 단위로 분리 가능합니다. 이는 아키텍쳐 원칙에서 가장 중요한 원칙인 관심사 분리를 통해 의존성을 분리하고 독립성을 가지게 합니다.<li>4️⃣ 장점 : 유연한 UI 구현이 가능합니다. (Navigation Component, BottomSheetDialog 등..)<li>1️⃣ 단점 : 비동기로 인해 예기치 않은 동작이 발생할 수 있습니다.<li>2️⃣ 단점 : <strong><em>Transaction 내에서 문제가 발생한다면 디버그가 매우 어려운 IllegalStateException을 발생시킵니다.</em></strong></ul></blockquote><li>StateFlow, Coroutine Channel을 사용하였습니다.<blockquote><p>Clean Architecture에서 LiveData 사용시 View의 의존성이 없는 Domain, Data Layer에서는 비동기 방식으로 데이터를 처리하기에 자연스러운 방법이 없기에 StateFlow, Coroutine Channel 을 사용하였습니다. <strong><em>참고</em></strong> : 해당 포스팅에 StateFlow, Channel 에 관하여 자세히 정리 했습니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-StateFlow/">StateFlow, Channel</a></p></blockquote><li>Dagger-Hilt 를 통한 DI(Dependency Injection) 관리를 적용하였습니다.<blockquote><p>Domain Layer, Data Layer 와 최종적으로 Presentation Layer의 의존성 관리를 위해 Hilt 를 사용하였습니다.</p></blockquote></ol><h2 id="clean-architecture-란"><span class="mr-2">Clean Architecture 란</span><a href="#clean-architecture-란" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><ul><li>Clean Code 로 소프트웨어 공학의 대가 <strong>“로버트 C.마틴”</strong>이 제시한 소프트웨어 디자인 철학입니다.<li>소프트웨어의 관심사를 계층별로(domain, data, presentation)로 분리하여 코드 종속성이 외부로부터 내부로 의존하도록 하는 것이 주요 원칙입니다.</ul><h2 id="clean-architecture-장점"><span class="mr-2">Clean Architecture 장점</span><a href="#clean-architecture-장점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><ul><li>코드의 재사용성이 용이해집니다.<blockquote><p><strong><em>참고</em></strong> : 멀티 모듈로 분리하여 작성시 API는 같고(회원가입, 로그인) 앱의 구성만 다른 경우 Domain Layer, Data Layer는 그대로 복사해서 가져와 사용할 수 있음</p></blockquote><li>Unit Test에 있어 용이해집니다.<blockquote><p><strong><em>참고</em></strong> : 비즈니스 규칙은 UI, DB, 백엔드 서버등 외부와 무관하게 테스팅이 가능합니다.</p></blockquote><li>UI 독립성<blockquote><p><strong><em>참고</em></strong> : UI 변경이 시스템의 나머지 부분에 영향을 미치지 않습니다.</p></blockquote><li>유지보수 용이<blockquote><p><strong><em>참고</em></strong> : 각 모듈의 의존성을 분리하므로 만약 코드 한 곳을 바꾼다고 하여도 나머지 부분을 변경할 필요가 없습니다.</p></blockquote></ul><h2 id="android-clean-architecture-구조"><span class="mr-2">Android Clean Architecture 구조</span><a href="#android-clean-architecture-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p><img data-src="/assets/img/architecture/clean-architecture-structure.png" alt="Desktop View" width="100%" data-proofer-ignore></p><ul><li>위의 사진을 참고하시면 이해가 쉽습니다.<li>위의 사진의 Entity는 Android에서는 Model로 정의합니다.<blockquote><p><strong><em>참고</em></strong> : Domain Layer의 Model은 사용자에게 직접 보여줄 Model 로 API에서 내려오는 Response에 직접 접근하지 않고 DTO를 통해 접근한다고 생각하시면 됩니다.</p></blockquote><li>아래에서 자세히 알아보겠습니다.<h3 id="1-domain-layer"><span class="mr-2">1. Domain Layer</span><a href="#1-domain-layer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50%&quot;, &quot;50%'%3E%3C/svg%3E" data-src="/assets/img/architecture/domain-layer-structure.png" alt="Desktop View" width="50%&quot;, height=&quot;50%" data-proofer-ignore></p><li>어떤 모듈에도 의존적이지 않는 독립적인 Module 입니다.(최상위 모듈)<li>비즈니스 로직을 처리하는 곳 입니다.<li>Data Layer에 접근하기 위한 interface를 갖고 있습니다. (Repository interface정의)<li>안드로이드에 의존성을 가지지 않은 순수 Java 및 Kotlin 코드로만 구성됩니다.<blockquote><p><strong><em>참고</em></strong> : Paging3를 사용 시 Android 의존성을 가지고있지 않을 방법이 없어 위의 그림에서는 어쩔 수 없이 android 의존성을 가졌습니다.</p></blockquote></ul><ol><li>UseCase<ul><li>행동들의 최소 단위, 즉 비즈니스 로직을 구현합니다.<blockquote><p><strong><em>참고</em></strong> : 사용자를 가져오는 UseCase, Login을 하는 UseCase, Token을 가져오는 UseCase 등이 포함 됩니다.</p></blockquote><li>보통 UseCase 하나당 하나의 기능을 담당합니다.<blockquote><p><strong><em>참고</em></strong> : UseCase 이름만 보고 이것이 무슨 기능을 하는지 짐작하고 구분할 수 있어야 합니다.</p></blockquote><li>Pesentation Layer 에서 어떠한 이벤트나 동작에 의하여 호출되는 방향으로 설계합니다.<blockquote><p><strong><em>참고</em></strong> : 보통 ViewModel 의 생성자에 DI(Dependency Inject)을 통해 주입받아 사용합니다.</p></blockquote><li>UseCase 생성시 어떤 DataBase or Remote(API)를 사용했는지에 대한 고민을 하지 않고 Domain Layer에서 정의한 Repository 함수를 호출하는 방식으로 정의합니다.<li>Data Layer 에서 실제로 어떻게 데이터를 가져올지에 대한 정의는 하지 않고 해당 Repository의 메서드를 호출하는 방식으로 구현합니다.<blockquote><p><strong><em>참고</em></strong> : 다음은 Naver 검색 API 를 통해 검색 결과를 PagingSource로 가져오는 UseCase 예제입니다. 👇</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">GetMovieListPagingDataUseCase</span> <span class="nd">@Inject</span> <span class="k">constructor</span><span class="p">(</span>
 <span class="k">private</span> <span class="kd">val</span> <span class="py">naverRepository</span><span class="p">:</span> <span class="nc">NaverRepository</span>
<span class="p">)</span> <span class="p">{</span>
 <span class="k">operator</span> <span class="k">fun</span> <span class="nf">invoke</span><span class="p">(</span>
   <span class="n">query</span><span class="p">:</span> <span class="nc">StateFlow</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;</span>
 <span class="p">):</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">PagingData</span><span class="p">&lt;</span><span class="nc">MovieInfoModel</span><span class="p">&gt;&gt;</span> <span class="p">{</span>
   <span class="k">return</span> <span class="n">naverRepository</span><span class="p">.</span><span class="nf">getMovieList</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></blockquote></ul><li>Repository<ul><li>데이터의 출처(Local DB 인지 API 응답인지 등..)와 관계없이 동일 Interface로 데이터에 접속할 수 있도록 만듭니다.<li>UseCase가 필요로 하는 데이터 저장/수정 등의 기능을 제공하는 Interface입니다.<li>Interface에 함수만 정의하고 구현은 Data Layer에서 합니다.<blockquote><p><strong><em>참고</em></strong> : 다음은 Naver 검색 API 를 통해 검색 결과를 PagingSource로 가져오는 Repository 예제입니다. 👇</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">NaverRepository</span> <span class="p">{</span>
 <span class="k">fun</span> <span class="nf">getMovieList</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nc">StateFlow</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;):</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">PagingData</span><span class="p">&lt;</span><span class="nc">MovieInfoModel</span><span class="p">&gt;&gt;</span>
<span class="p">}</span>
</pre></table></code></div></div></blockquote></ul><li>Model<ul><li>앱의 실질적인 데이터가 여기에 구현됩니다. 즉, UI에 보여질 실제 데이터입니다.<blockquote><ul><li><strong><em>참고</em></strong> : 만약 API 호출을 통해 Response를 받아 왔다면 해당 Response에 직접 접근하지 않고 Domain Layer의 Model을 통해 접근한다고 생각하시면 됩니다. DTO(Data Transfer Object)와 유사하다고 보시면 됩니다.<li><strong><em>참고</em></strong> : 다음은 Naver 검색 API 를 통해 검색 결과의 사용자에게 직접 보여줄 Model 예제입니다. 👇<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">data class</span> <span class="nc">MovieInfoModel</span><span class="p">(</span>
 <span class="kd">val</span> <span class="py">title</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">link</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">image</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">subtitle</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">pubDate</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">director</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">actor</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
 <span class="kd">val</span> <span class="py">userRating</span><span class="p">:</span> <span class="nc">Float</span>
<span class="p">)</span> <span class="p">{</span>
 <span class="kd">val</span> <span class="py">rating</span> <span class="p">=</span> <span class="n">userRating</span> <span class="p">/</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></table></code></div></div></ul></blockquote></ul></ol><h3 id="2-data-layer"><span class="mr-2">2. Data Layer</span><a href="#2-data-layer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50%&quot;, &quot;50%'%3E%3C/svg%3E" data-src="/assets/img/architecture/data-layer-structure.png" alt="Desktop View" width="50%&quot;, height=&quot;50%" data-proofer-ignore></p><ul><li>Domain Layer에서 정의한 Repository 구현제, dataSource, Retrofit API 정의, Room DB 정의, Mapper, API Response Model 등으로 구성됩니다.<li>Domain Layer에 대한 의존성을 가지고 있습니다.<li>데이터 베이스(Local DB)와 서버(Remote)의 통신을 담당합니다.<li>✔️ <strong>Data Model</strong> : API 통신을 통해서 받게되는 Response 나 Local DB를 통해 얻게되는 Entity를 정의합니다.<blockquote><p><strong><em>참고</em></strong> : 다음은 Naver 검색 API 를 통해 검색 결과 Response 입니다. 👇</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">data class</span> <span class="nc">MovieResponse</span><span class="p">(</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"lastBuildDate"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">lastBuildDate</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"total"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">total</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"start"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">start</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"display"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">display</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"items"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">items</span><span class="p">:</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MovieInfo</span><span class="p">&gt;</span>
<span class="p">)</span>
<span class="kd">data class</span> <span class="nc">MovieInfo</span><span class="p">(</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"title"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">title</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"link"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">link</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"image"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">image</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"subtitle"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">subtitle</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"pubDate"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">pubDate</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"director"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">director</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"actor"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">actor</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@SerializedName</span><span class="p">(</span><span class="s">"userRating"</span><span class="p">)</span>
  <span class="kd">val</span> <span class="py">userRating</span><span class="p">:</span> <span class="nc">String</span>
<span class="p">)</span>
</pre></table></code></div></div><hr /></blockquote><li>✔️ <strong>DataSource</strong><li>🚩 RemoteDataSource : 네트워크 통신을 담당하는 interface 입니다.<li>🚩 LocalDataSource : Local Database와의 통신을 담당하는 interface 입니다.<li><strong><em>참고</em></strong> : 다음은 Naver 검색 API 에 접근하는 RemoteDataSource 입니다. 👇<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">RemoteDataSource</span> <span class="p">{</span>
  <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">requestSearchMovie</span><span class="p">(</span>
      <span class="n">query</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
      <span class="n">start</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
      <span class="n">display</span><span class="p">:</span> <span class="nc">Int</span>
  <span class="p">):</span> <span class="nc">Response</span><span class="p">&lt;</span><span class="nc">MovieResponse</span><span class="p">&gt;</span>
<span class="p">}</span>
</pre></table></code></div></div><li><strong><em>참고</em></strong> : 다음은 Naver 검색 API 에 접근하는 RemoteDataSource의 구현체입니다. Hilt로 부터 생성자에 NaverApiService를 주입받아 사용합니다. 👇<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">RemoteDataSourceImpl</span> <span class="nd">@Inject</span> <span class="k">constructor</span><span class="p">(</span>
  <span class="k">private</span> <span class="kd">val</span> <span class="py">naverApiService</span><span class="p">:</span> <span class="nc">NaverApiService</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">RemoteDataSource</span> <span class="p">{</span>

  <span class="k">override</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">requestSearchMovie</span><span class="p">(</span>
      <span class="n">query</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
      <span class="n">start</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
      <span class="n">display</span><span class="p">:</span> <span class="nc">Int</span>
  <span class="p">):</span> <span class="nc">Response</span><span class="p">&lt;</span><span class="nc">MovieResponse</span><span class="p">&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">naverApiService</span><span class="p">.</span><span class="nf">searchMovie</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">display</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /><li>✔️ <strong>Api</strong><li>🚩 Retrofit 을 이용한 Netwrok 통신을 하기 위한 interface 입니다.<li>🚩 Url에 접근하는 함수만 만들어 놓고, Retrofit의 인스턴스 생성 및 세팅은 Hilt를 통해합니다.<blockquote><p><strong><em>참고</em></strong> : GET 방식을 사용하며 Query로 query, start, display를 넣어주고 있습니다. 여기서 start는 아이템 시작 index이며, display는 limit 입니다.<br /> 다음은 Naver 검색 API URL에 접근하는 코드입니다. 👇</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">interface</span> <span class="nc">NaverApiService</span> <span class="p">{</span>
      <span class="nd">@GET</span><span class="p">(</span><span class="s">"/v1/search/movie"</span><span class="p">)</span>
      <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">searchMovie</span><span class="p">(</span>
          <span class="nd">@Query</span><span class="p">(</span><span class="s">"query"</span><span class="p">)</span> <span class="n">query</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
          <span class="nd">@Query</span><span class="p">(</span><span class="s">"start"</span><span class="p">)</span> <span class="n">start</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span>
          <span class="nd">@Query</span><span class="p">(</span><span class="s">"display"</span><span class="p">)</span> <span class="n">display</span><span class="p">:</span> <span class="nc">Int</span>
      <span class="p">):</span> <span class="nc">Response</span><span class="p">&lt;</span><span class="nc">MovieResponse</span><span class="p">&gt;</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /></blockquote><li>✔️ <strong>Repository (Domain Layer의 Repository 구현체)</strong><li>🚩 DataSource 를 interface 형태로 참조하여 Domain Layer의 Repository를 구현합니다.<blockquote><p><strong><em>참고</em></strong> : DI(Dependency Inject)을 사용하여 생성자에 DataSource를 주입받습니다.</p></blockquote><li>🚩 실제로 어떻게 데이터를 가져올지에 대한 정의를 하여 UseCase에서 해당 Repository 구현체의 함수를 사용합니다.<blockquote><p><strong><em>참고</em></strong> : 해당 코드에서는 Paging3를 사용하여 Naver API Response 결과를 Flow&lt;PagingSource<T>&gt; 의 형태로 가져옵니다. 👇</T></p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">NaverRepositoryImpl</span> <span class="nd">@Inject</span> <span class="k">constructor</span><span class="p">(</span>
      <span class="k">private</span> <span class="kd">val</span> <span class="py">remoteDataSource</span><span class="p">:</span> <span class="nc">RemoteDataSource</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">NaverRepository</span> <span class="p">{</span>
      <span class="k">override</span> <span class="k">fun</span> <span class="nf">getMovieList</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nc">StateFlow</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;):</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">PagingData</span><span class="p">&lt;</span><span class="nc">MovieInfoModel</span><span class="p">&gt;&gt;</span> <span class="p">{</span>
          <span class="k">return</span> <span class="nc">Pager</span><span class="p">(</span>
              <span class="n">config</span> <span class="p">=</span> <span class="nc">PagingConfig</span><span class="p">(</span><span class="n">pageSize</span> <span class="p">=</span> <span class="mi">10</span><span class="p">),</span>
              <span class="n">pagingSourceFactory</span> <span class="p">=</span> <span class="p">{</span>
                  <span class="nc">MovieInfoListPagingDataSource</span><span class="p">(</span>
                      <span class="n">remoteDataSource</span> <span class="p">=</span> <span class="n">remoteDataSource</span><span class="p">,</span>
                      <span class="n">searchQuery</span> <span class="p">=</span> <span class="n">query</span><span class="p">,</span>
                      <span class="n">limit</span> <span class="p">=</span> <span class="mi">10</span>
                  <span class="p">)</span>
              <span class="p">}</span>
          <span class="p">).</span><span class="n">flow</span><span class="p">.</span><span class="nf">distinctUntilChanged</span><span class="p">().</span><span class="nf">flowOn</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span>
      <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /></blockquote><li>✔️ <strong>Mapper</strong><li>🚩 Data Model 에 의해 가져온 Data를 Domain Model 로 맞게 바꿔주는 매핑 작업을 하여 UseCase 에서 Domain Model 을 반환합니다.<blockquote><p><strong><em>참고</em></strong> : API 를 통해 받아온 Response를 UI에 맞는 Domain Model로 맵핑 👇 (Kotlin 확장 함수 기능을 사용하여 처리합니다.)</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kd">object</span> <span class="nc">ObjectMapper</span> <span class="p">{</span>
      <span class="c1">// List&lt;MovieInfo&gt; -&gt; List&lt;MovieInfoModel&gt; 로 변환</span>
      <span class="k">fun</span> <span class="nf">List</span><span class="p">&lt;</span><span class="nc">MovieInfo</span><span class="p">&gt;.</span><span class="nf">toMovieInfoListModel</span><span class="p">():</span> <span class="nc">List</span><span class="p">&lt;</span><span class="nc">MovieInfoModel</span><span class="p">&gt;</span> <span class="p">=</span> <span class="nf">map</span> <span class="p">{</span>
          <span class="nc">MovieInfoModel</span><span class="p">(</span>
              <span class="n">title</span> <span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
              <span class="n">link</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">link</span><span class="p">,</span>
              <span class="n">image</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">image</span><span class="p">,</span>
              <span class="n">subtitle</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">subtitle</span><span class="p">,</span>
              <span class="n">pubDate</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">pubDate</span><span class="p">,</span>
              <span class="n">director</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">director</span><span class="p">,</span>
              <span class="n">actor</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">actor</span><span class="p">,</span>
              <span class="n">userRating</span><span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">userRating</span><span class="p">.</span><span class="nf">toFloat</span><span class="p">()</span>
          <span class="p">)</span>
      <span class="p">}</span>
      <span class="c1">// MovieInfo -&gt; MovieInfoModel 로 변환</span>
      <span class="k">fun</span> <span class="nc">MovieInfo</span><span class="p">.</span><span class="nf">toMovieInfoModel</span><span class="p">():</span> <span class="nc">MovieInfoModel</span> <span class="p">=</span> <span class="nc">MovieInfoModel</span><span class="p">(</span>
          <span class="n">title</span> <span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">title</span><span class="p">,</span>
          <span class="n">link</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">link</span><span class="p">,</span>
          <span class="n">image</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">image</span><span class="p">,</span>
          <span class="n">subtitle</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">subtitle</span><span class="p">,</span>
          <span class="n">pubDate</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">pubDate</span><span class="p">,</span>
          <span class="n">director</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">director</span><span class="p">,</span>
          <span class="n">actor</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">actor</span><span class="p">,</span>
          <span class="n">userRating</span><span class="p">=</span> <span class="k">this</span><span class="p">.</span><span class="n">userRating</span><span class="p">.</span><span class="nf">toFloat</span><span class="p">()</span>
      <span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><hr /></blockquote><li>✔️ <strong>MovieInfoListPagingDataSource</strong><li>🚩 Naver로 부터 받아오는 Response 의 값을 PagingSource에 담아 반환합니다.<blockquote><p><strong><em>참고</em></strong></p><ul><li>해당 프로젝트는 Paging3를 사용하고 있습니다.<li>Hilt를 사용하여 remoteDataSource 를 생성자에 주입받고 있습니다.<li><strong><em>참고</em></strong> : 해당 포스팅에 Paging3에 관하여 자세히 정리 했습니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-Paging3/">Paging3에 대하여</a></ul></blockquote></ul><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">MovieInfoListPagingDataSource</span> <span class="nd">@Inject</span> <span class="k">constructor</span><span class="p">(</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">remoteDataSource</span><span class="p">:</span> <span class="nc">RemoteDataSource</span><span class="p">,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">searchQuery</span><span class="p">:</span> <span class="nc">StateFlow</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">limit</span><span class="p">:</span> <span class="nc">Int</span>
<span class="p">)</span> <span class="p">:</span> <span class="nc">PagingSource</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">MovieInfoModel</span><span class="p">&gt;()</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">suspend</span> <span class="k">fun</span> <span class="nf">load</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="nc">LoadParams</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;):</span> <span class="nc">LoadResult</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">MovieInfoModel</span><span class="p">&gt;</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">pageNumber</span> <span class="p">=</span> <span class="n">params</span><span class="p">.</span><span class="n">key</span> <span class="o">?:</span> <span class="mi">1</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">response</span> <span class="p">=</span> <span class="nf">withContext</span><span class="p">(</span><span class="nc">Dispatchers</span><span class="p">.</span><span class="nc">IO</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">remoteDataSource</span><span class="p">.</span><span class="nf">requestSearchMovie</span><span class="p">(</span>
                    <span class="n">query</span> <span class="p">=</span> <span class="n">searchQuery</span><span class="p">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="n">start</span> <span class="p">=</span> <span class="n">pageNumber</span><span class="p">,</span>                        
                    <span class="n">display</span> <span class="p">=</span> <span class="n">limit</span>
                <span class="p">)</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="n">isSuccessful</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">()</span><span class="o">?.</span><span class="nf">let</span> <span class="p">{</span>
                    <span class="kd">val</span> <span class="py">movieList</span> <span class="p">=</span> <span class="n">it</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="nf">toMovieInfoListModel</span><span class="p">()</span>
                    <span class="cm">/**
                     * nextKey -&gt; naver Api의 start 는 index 이고, 현재 display(limit) 가 10 이므로
                     * 10 이후에 start 값은 11 이 되어야함
                     * 스크롤되어 페이지가 추가될때 마다 10개씩 가져온다.
                     */</span>
                    <span class="k">return</span> <span class="nc">LoadResult</span><span class="p">.</span><span class="nc">Page</span><span class="p">(</span>
                        <span class="n">data</span> <span class="p">=</span> <span class="n">movieList</span><span class="p">,</span>
                        <span class="n">prevKey</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span>
                        <span class="n">nextKey</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="n">items</span><span class="p">.</span><span class="n">size</span> <span class="p">&gt;=</span> <span class="n">limit</span><span class="p">)</span> <span class="p">{</span>
                            <span class="n">pageNumber</span> <span class="p">+</span> <span class="n">limit</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="k">null</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nc">LoadResult</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span>
                <span class="nc">LoadException</span><span class="p">(</span><span class="s">"영화 정보를 가져오는데 실패하였습니다."</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">e</span><span class="p">:</span> <span class="nc">Exception</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">Timber</span><span class="p">.</span><span class="nf">e</span><span class="p">(</span><span class="s">"paging catch Error -&gt; ${e.message}"</span><span class="p">)</span>
            <span class="k">return</span> <span class="nc">LoadResult</span><span class="p">.</span><span class="nc">Error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getRefreshKey</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="nc">PagingState</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">,</span> <span class="nc">MovieInfoModel</span><span class="p">&gt;):</span> <span class="nc">Int</span><span class="p">?</span> <span class="p">{</span>
        <span class="c1">// 새로고침 될때 항상 전부 새로고침 되도록 null 을 return</span>
        <span class="k">return</span> <span class="k">null</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="3-presentation-layer-app-module"><span class="mr-2">3. Presentation Layer (App Module)</span><a href="#3-presentation-layer-app-module" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50%&quot;, &quot;50%'%3E%3C/svg%3E" data-src="/assets/img/architecture/presentation-layer-structure.png" alt="Desktop View" width="50%&quot;, height=&quot;50%" data-proofer-ignore></p><ul><li>화면의 입력에 대한 처리 등 UI와 관련된 부분을 담당합니다.<blockquote><p><strong><em>참고</em></strong> : Activity, Fragment, View, ViewModel, Di 등을 포함합니다.</p></blockquote><li>Android에 높은 의존성을 가지고 있습니다.<li>Domain Layer, Data Layer 에 대한 의존성을 가지고 있습니다.<li>ViewModel에서 domain layer의 UseCase를 주입 받아 사용하여 각 ViewModel당 기능 이 무엇인지 쉽게 알 수 있습니다.<li>MVVM 패턴을 사용하여 ViewModel에서 데이터를 받아 View(Activity/Fragment)에 넘겨주는 방식으로 구현되어 있습니다.<li>해당 프로젝트는 Single Activity를 적용했습니다.<blockquote><p><strong><em>참고</em></strong> Single Activity의 장단점</p><ul><li>1️⃣ 장점 : Activity Stack에 Activity를 쌓아두기 보다. Fragment BackStack에서 Fragment를 관리하는 것이 메모리 관리에서의 효율도 챙기고 화면 전환시 Activity 보다 순조롭습니다.<li>2️⃣ 장점 : 데이터 공유에 있어 이점이 있습니다. Activity간 Data를 전달하려면 Intent를 통해 직렬화/역직렬화를 과정을 거쳐야 하며, 이는 메모리 공유에 비해 결코 가벼운 작업이 아닙니다.<li>3️⃣ 장점 : 재사용성이 증가합니다. View 나 Business Logic을 Fragment 단위로 분리 가능합니다. 이는 아키텍쳐 원칙에서 가장 중요한 원칙인 관심사 분리를 통해 의존성을 분리하고 독립성을 가지게 합니다.<li>4️⃣ 장점 : 유연한 UI 구현이 가능합니다. (Navigation Component, BottomSheetDialog 등..)<li>1️⃣ 단점 : 비동기로 인해 예기치 않은 동작이 발생할 수 있습니다.<li>2️⃣ 단점 : <strong><em>Transaction 내에서 문제가 발생한다면 디버그가 매우 어려운 IllegalStateException을 발생시킵니다.</em></strong></ul></blockquote><li>✔️ <strong>Base</strong><li>🚩 Presentaion Layer의 Base에 사용될 Class 모음입니다.<blockquote><ul><li>해당 프로젝트에는 BaseActivity, BaseFragment, BaseViewModel, BaseDialogFragment, MyLoadStateAdapter 가 정의되어 있습니다.<li><strong><em>참고</em></strong> -&gt; <a href="https://github.com/narvis2/MovieSearchApp/tree/main/app/src/main/java/com/example/moviesearchapp/base">깃허브</a></ul></blockquote><li>✔️ <strong>Di</strong><li>🚩 DI(Dependency Injection) 즉 의존성을 관리하는 페지키 입니다.<li>1️⃣ ApiModule : Hilt Module로 관리하며 @InstallIn에 SingletonComponent를 넣어 관리되고 있습니다.<blockquote><ul><li>SingletonComponent는 @Singleton 어노테이션과 같이 사용되며, Application이 onCreate()가 되면 생성되고, Application이 onDestory()가 되면 자동으로 파괴됩니다.<li>ApiModule 에서는 Retrofit 인스턴스를 만들어 Hilt 를 통해 Provide합니다. 해당 부분에서 OkHttp3 Interceptor 를 사용하여 Header 부분에 <strong>X-Naver-Client-Id</strong> 와 <strong>X-Naver-Client-Secret</strong>를 넣어줍니다.<li>Hilt 를 통해 NaverApiService를 제공하고 있으며, 해당 NaverApiService는 RemoteDataSource의 생성자에 주입됩니다. 또한 RemoteDataSource 역시 Hilt를 통해 제공되고 있습니다. (이렇게 제공된 RemoteDataSource는 Hilt를 통해 RepositoryModule의 생성자에서 주입 받습니다.)<li>다음은 ApiModule 코드 입니다. 👇 <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/di/ApiModule.kt">깃허브</a></ul></blockquote></ul><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">SingletonComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">object</span> <span class="nc">ApiModule</span> <span class="p">{</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideRemoteDataSource</span><span class="p">(</span>
        <span class="n">naverApiService</span><span class="p">:</span> <span class="nc">NaverApiService</span>
    <span class="p">):</span> <span class="nc">RemoteDataSource</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">RemoteDataSourceImpl</span><span class="p">(</span>
            <span class="n">naverApiService</span>
        <span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideNaverApiService</span><span class="p">(</span>
        <span class="n">retrofit</span><span class="p">:</span> <span class="nc">Retrofit</span>
    <span class="p">):</span> <span class="nc">NaverApiService</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">retrofit</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="nc">NaverApiService</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideRetrofit</span><span class="p">(</span>
        <span class="n">client</span><span class="p">:</span> <span class="nc">OkHttpClient</span><span class="p">,</span>
        <span class="n">converter</span><span class="p">:</span> <span class="nc">GsonConverterFactory</span>
    <span class="p">):</span> <span class="nc">Retrofit</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">Retrofit</span><span class="p">.</span><span class="nc">Builder</span><span class="p">()</span>
            <span class="p">.</span><span class="nf">baseUrl</span><span class="p">(</span><span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">API_HOST</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">addConverterFactory</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">build</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideGsonConverterFactory</span><span class="p">():</span> <span class="nc">GsonConverterFactory</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">GsonConverterFactory</span><span class="p">.</span><span class="nf">create</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideOkHttpClient</span><span class="p">(</span>
        <span class="n">logging</span><span class="p">:</span> <span class="nc">HttpLoggingInterceptor</span><span class="p">,</span>
        <span class="n">interceptor</span><span class="p">:</span> <span class="nc">Interceptor</span><span class="p">,</span>
    <span class="p">):</span> <span class="nc">OkHttpClient</span> <span class="p">=</span> <span class="nc">OkHttpClient</span><span class="p">.</span><span class="nc">Builder</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">DEBUG</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">addInterceptor</span><span class="p">(</span><span class="n">logging</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">addInterceptor</span><span class="p">(</span><span class="n">interceptor</span><span class="p">)</span>
    <span class="p">}.</span><span class="nf">build</span><span class="p">()</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideLoggingInterceptor</span><span class="p">():</span> <span class="nc">HttpLoggingInterceptor</span> <span class="p">=</span> <span class="nc">HttpLoggingInterceptor</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="n">level</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">DEBUG</span><span class="p">)</span> <span class="p">{</span>
            <span class="nc">HttpLoggingInterceptor</span><span class="p">.</span><span class="nc">Level</span><span class="p">.</span><span class="nc">BODY</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nc">HttpLoggingInterceptor</span><span class="p">.</span><span class="nc">Level</span><span class="p">.</span><span class="nc">NONE</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Singleton</span>
    <span class="nd">@Provides</span>
    <span class="k">fun</span> <span class="nf">provideInterceptor</span><span class="p">():</span> <span class="nc">Interceptor</span> <span class="p">=</span> <span class="nc">Interceptor</span> <span class="p">{</span> <span class="n">chain</span> <span class="p">-&gt;</span>
        <span class="kd">val</span> <span class="py">response</span> <span class="p">=</span> <span class="n">chain</span><span class="p">.</span><span class="nf">proceed</span><span class="p">(</span>
            <span class="n">chain</span><span class="p">.</span><span class="nf">request</span><span class="p">().</span><span class="nf">newBuilder</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
                <span class="nf">addHeader</span><span class="p">(</span><span class="s">"X-Naver-Client-Id"</span><span class="p">,</span> <span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">NAVE_CLIENT_ID</span><span class="p">)</span>
                <span class="nf">addHeader</span><span class="p">(</span><span class="s">"X-Naver-Client-Secret"</span><span class="p">,</span> <span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">NAVE_CLIENT_SECRET</span><span class="p">)</span>
            <span class="p">}.</span><span class="nf">build</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">response</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li>2️⃣ RepositoryModule : Hilt Module로 관리하며 @InstallIn에 SingletonComponent를 넣어 관리되고 있습니다.<blockquote><ul><li>SingletonComponent는 @Singleton 어노테이션과 같이 사용되며, Application이 onCreate()가 되면 생성되고, Application이 onDestory()가 되면 자동으로 파괴됩니다.<li>Hilt를 통해 생성자로 부터 RemoteDataSource를 주입받아 사용하고 있으며 NaverRepository를 Hilt를 통해 제공합니다.<li>다음은 Repository Module Code 입니다. 👇 <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/di/RepositoryModule.kt">깃허브</a><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">SingletonComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">object</span> <span class="nc">RepositoryModule</span> <span class="p">{</span>
    <span class="nd">@Provides</span>
    <span class="nd">@Singleton</span>
    <span class="k">fun</span> <span class="nf">provideNaverRepository</span><span class="p">(</span>
        <span class="n">remoteDataSource</span><span class="p">:</span> <span class="nc">RemoteDataSource</span>
    <span class="p">):</span> <span class="nc">NaverRepository</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">NaverRepositoryImpl</span><span class="p">(</span><span class="n">remoteDataSource</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></ul></blockquote><li>3️⃣ UseCaseModule : Hilt Module로 관리하여 @InstallIn 에 ViewModelComponent 를 넣어 관리되고 있습니다.<blockquote><ul><li>해당 UseCase는 ViewModel 의 생성자에 주입받아 사용됩니다. 따라서 @InstallIn 에 ViewModelComponent를 사용합니다.<li>ViewModelComponent 는 @ViewModelScope 와 같이 사용되며, AAC ViewModel의 생명주기에 따라 관리됩니다.<li>즉, ViewModel 이 생성되면 생성되고, ViewModel의 onCleared()가 호출되면 자동으로 파괴됩니다.<li>다음은 UseCase Module Code 입니다. 👇 <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/di/UseCaseModule.kt">깃허브</a><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="nc">ViewModelComponent</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
<span class="kd">object</span> <span class="nc">UseCaseModule</span> <span class="p">{</span>
    <span class="nd">@Provides</span>
    <span class="nd">@ViewModelScoped</span>
    <span class="k">fun</span> <span class="nf">provideGetMovieListPagingDataUseCase</span><span class="p">(</span>
        <span class="n">naverRepository</span><span class="p">:</span> <span class="nc">NaverRepository</span>
    <span class="p">):</span> <span class="nc">GetMovieListPagingDataUseCase</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nc">GetMovieListPagingDataUseCase</span><span class="p">(</span><span class="n">naverRepository</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></ul></blockquote><li>✔️ <strong>MovieApplication</strong><li>🚩 Hilt를 사용하도록 설정하고 Debug에 필요한 Timber를 등록합니다.<blockquote><p><strong><em>참고</em></strong> : @HiltAndroidApp -&gt; 컴파일 타임 시 표준 컴포넌트 빌딩에 필요한 클래스들을 초기화 해줍니다. Hilt를 사용하는 모든 앱은 @HiltAndroidApp 이 달린 Application 클래스를 반드시 포함해야 합니다.</p><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nd">@HiltAndroidApp</span>
<span class="kd">class</span> <span class="nc">MovieApplication</span> <span class="p">:</span> <span class="nc">Application</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">super</span><span class="p">.</span><span class="nf">onCreate</span><span class="p">()</span>
      <span class="k">if</span> <span class="p">(</span><span class="nc">BuildConfig</span><span class="p">.</span><span class="nc">DEBUG</span><span class="p">)</span> <span class="p">{</span>
          <span class="nc">Timber</span><span class="p">.</span><span class="nf">plant</span><span class="p">(</span><span class="nc">TimberDebugTree</span><span class="p">())</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></blockquote><li>✔️ <strong>Activity</strong><li>🚩 해당 프로젝트에서는 MainActivity 와 WebViewActivity로 구분됩니다.<li>1️⃣ MainActivity : 해당 프로젝트는 SingleActivity를 채택하고 있어 MainActivity 에서는 Navigation의 NavHostFragment를 연결해주고 있으며, Network 관리를 통해 Network Callback을 등록하고 Network 상태 값을 Observing 하는 코드가 포함되어 있습니다. 또한 뒤로 가기 클릭 시 한번 눌렀을 경우 “한번 더 누르면 종료됩니다.” 라는 SnackBar를 띄워주기 위해 BackStack을 관리하는 코드가 포함되어 있습니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/view/activity/main/MainActivity.kt">깃허브</a><li><p>2️⃣ WebViewActivity : 영화 상세 정보를 WebView로 띄워주기 위해 생성했습니다. onPause()와 onResume(), onDestory()에 따라 WebView를 관리해주고 있으며, Intent를 통해 Main -&gt; WebView 로 이동 시 내부/외부 WebView를 띄워줄 수 있는 코드가 포함되어 있습니다. 해당 WebViewActivity는 내부 웹뷰 일 경우 동작합니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/view/activity/web/WebViewActivity.kt">깃허브</a></p><li>✔️ <strong>Fragment</strong><li>🚩 해당 프로젝트에서는 HomeFragment 와 NetworkFragment로 구분됩니다.<li>1️⃣ HomeFragment : 네이버 Open API 를 활용하여 영화 정보를 받아와 사용자에게 보여주는 역할을 합니다. 또한 NavHostFragment로 모든 Navgigation의 시작점이 됩니다. 네이버 Open API 를 활용하여 영화 정보를 받아와 사용자에게 보여 주기 위해 RecyclerView 를 포함하고 있으며, 또한 PagingData의 Load 상태에 따라 DataBinding으로 View를 Controll 하고 있습니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/view/fragment/home/HomeFragment.kt">깃허브</a><li>2️⃣ HomeViewModel : 앞서 Domain Layer의 UseCase를 Hilt를 통해 생성자에 주입받아 네이버 Open API 데이터를 가져오는 역할을 합니다. 이렇게 가져온 데이터는 HomeFragment 에서 Observing 하여 RecyclerView 에 넣어줍니다. 또한 MutableStateFlow를 사용하여 Data Binding을 통해 HomeFragment 의 View를 Controll 해주고 있으며, Coroutine Channel 을 통해 해당 Click Event의 Listener를 관리하고 있습니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/view/fragment/home/HomeViewModel.kt">깃허브</a><li>3️⃣ NetworkFragment : 네트워크가 끊겼을 때 보여주는 DialogFragment 입니다. 네트워크가 연결되면 자동으로 dialog를 dissmiss 해주는 코드를 포함하고 해당 다이얼로그가 보여질 때 다른 View에서는 해당 다이얼로그를 Cancel 하지 못하게하는 코드가 포함되어 있습니다.<li>4️⃣ NetworkViewModel : ConnectivityManager를 통해 Network Callback을 받아 Network를 관리하는 코드가 포함되어 있습니다. 해당 ViewModel은 MainActivity에서 생성되며, NetworkFragment 에서는 FragmentX를 사용하여 activityViewModels() 코드로 Fragment 상태를 공유합니다.<blockquote><p>Network 관리에 대해서는 옆의 포스팅을 참고하시길 바랍니다. 👉 <a href="https://narvis2.github.io/posts/Android-Network/">Android ConnectivityManager를 통한 Network 관리</a></p></blockquote><li>✔️<strong>MovieInfoAdapter(PagingAdapter)</strong><li>RecyclerView 에 데이터를 표시하는 기본 UI 구성요소 입니다.<li>PagingData를 입력 유형으로 사용하고 내부 load 이벤트를 수신합니다.<li>BackGround Thread 에서 DiffUtil 을 사용하여 미세 조정한 후 데이터를 load하므로 UI Thread에 새 항복을 추가하는 동안 문제가 발생하지 않습니다.<li>Root Click Listener를 포함하고 있고 Domain Layer에 정의한 MovieInfoModel을 데이터로 사용합니다.<li>해당 Adapter 또한 Data Binding을 통해 View에 데이터를 연결해주고 있습니다.<blockquote><ul><li><strong><em>참고</em></strong> : <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/view/fragment/home/adapter/MovieInfoAdapter.kt">깃허브</a><li><strong><em>참고</em></strong> : 해당 포스팅에 Paging3에 관하여 자세히 정리 했습니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-Paging3/">Paging3에 대하여</a></ul></blockquote><li>✔️<strong>Utils</strong><li>🚩 해당 프로젝트에서는 데이터 바인딩을 위한 BindingAdapters, Flow를 Lifecycler에 맞게 Observing하기 위해 만들어진 FlowObserver, keyBoardUtils, Listener, TimberDebugTree 등이 포함되어 있습니다.<li>1️⃣ BindingAdpaters <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/utils/BindingAdapters.kt">깃허브</a><blockquote><ul><li>서버에서 받아오는 image Url을 ImageView에 넣어주기 위해 Glide를 사용하는 함수, Html 을 String으로 바꿔주는 함수, 중복 클릭 방지 함수 등이 포함되어 있습니다.</ul></blockquote><li><blockquote><p><strong><em>참고</em></strong> : 다음은 Glide에 대해 자세한 내용을 기록한 포스팅입니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-Glide/">Glide Image 처리</a></p></blockquote><li>image Load 함수 👇<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="nd">@BindingAdapter</span><span class="p">(</span><span class="n">value</span> <span class="p">=</span> <span class="p">[</span><span class="s">"loadImage"</span><span class="p">,</span> <span class="s">"placeHolder"</span><span class="p">,</span> <span class="s">"error"</span><span class="p">],</span> <span class="n">requireAll</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
<span class="k">fun</span> <span class="nc">ImageView</span><span class="p">.</span><span class="nf">loadImage</span><span class="p">(</span>
  <span class="n">imageUrl</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span>
  <span class="nd">@DrawableRes</span>
  <span class="n">placeholder</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="nd">@DrawableRes</span>
  <span class="n">error</span><span class="p">:</span> <span class="nc">Int</span> <span class="p">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="p">{</span>
  <span class="c1">// imageUrl 이 비어있을 때 로직 추가</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">imageUrl</span><span class="p">.</span><span class="nf">isEmpty</span><span class="p">())</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">placeholder</span> <span class="p">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nf">setImageResource</span><span class="p">(</span><span class="n">placeholder</span><span class="p">)</span>
      <span class="p">}</span>

      <span class="k">return</span>
  <span class="p">}</span>

  <span class="kd">val</span> <span class="py">options</span> <span class="p">=</span> <span class="nc">RequestOptions</span><span class="p">()</span>

  <span class="nd">@SuppressLint</span><span class="p">(</span><span class="s">"CheckResult"</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">error</span> <span class="p">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// 로드가 실패할 경우 표시할 리소스를 설정합니다.</span>
      <span class="n">options</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="nc">Glide</span><span class="p">.</span><span class="nf">with</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">context</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">setDefaultRequestOptions</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
      <span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">imageUrl</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span>
          <span class="nd">@SuppressLint</span><span class="p">(</span><span class="s">"CheckResult"</span><span class="p">)</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">placeholder</span> <span class="p">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
              <span class="c1">// 리소스가 로드되는 동안 표시할 드로어블 리소스의 Android 리소스 ID를 설정합니다.</span>
              <span class="nf">apply</span><span class="p">(</span><span class="n">options</span><span class="p">.</span><span class="nf">placeholder</span><span class="p">(</span><span class="n">placeholder</span><span class="p">))</span>
          <span class="p">}</span>
      <span class="p">}</span>
      <span class="p">.</span><span class="nf">into</span><span class="p">(</span><span class="kd">object</span> <span class="err">: </span><span class="nc">CustomTarget</span><span class="p">&lt;</span><span class="nc">Drawable</span><span class="p">&gt;()</span> <span class="p">{</span>
          <span class="k">override</span> <span class="k">fun</span> <span class="nf">onResourceReady</span><span class="p">(</span><span class="n">resource</span><span class="p">:</span> <span class="nc">Drawable</span><span class="p">,</span> <span class="n">transition</span><span class="p">:</span> <span class="nc">Transition</span><span class="p">&lt;</span><span class="k">in</span> <span class="nc">Drawable</span><span class="p">&gt;?)</span> <span class="p">{</span>
              <span class="nf">setImageDrawable</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span>
          <span class="p">}</span>

          <span class="k">override</span> <span class="k">fun</span> <span class="nf">onLoadCleared</span><span class="p">(</span><span class="n">placeholder</span><span class="p">:</span> <span class="nc">Drawable</span><span class="p">?)</span> <span class="p">{</span>
              <span class="nf">setImageDrawable</span><span class="p">(</span><span class="n">placeholder</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">})</span>
<span class="p">}</span>
</pre></table></code></div></div><li>중복 클릭 방지 함수<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nd">@BindingAdapter</span><span class="p">(</span><span class="n">value</span> <span class="p">=</span> <span class="p">[</span><span class="s">"onSingleClick"</span><span class="p">,</span> <span class="s">"interval"</span><span class="p">],</span> <span class="n">requireAll</span> <span class="p">=</span> <span class="k">false</span><span class="p">)</span>
<span class="k">fun</span> <span class="nc">View</span><span class="p">.</span><span class="nf">onSingleClick</span><span class="p">(</span><span class="n">listener</span><span class="p">:</span> <span class="nc">View</span><span class="p">.</span><span class="nc">OnClickListener</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nc">Long</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">listener</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="nf">setOnClickListener</span><span class="p">(</span><span class="kd">object</span> <span class="err">: </span><span class="nc">Listener</span><span class="p">.</span><span class="nc">OnSingleClickListener</span><span class="p">(</span><span class="n">interval</span> <span class="o">?:</span> <span class="mi">1000L</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">override</span> <span class="k">fun</span> <span class="nf">onSingleClick</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="nc">View</span><span class="p">?)</span> <span class="p">{</span>
              <span class="n">listener</span><span class="p">.</span><span class="nf">onClick</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
          <span class="p">}</span>
      <span class="p">})</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nf">setOnClickListener</span><span class="p">(</span><span class="k">null</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><li>Html을 String으로 바꿔주는 함수<div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nd">@BindingAdapter</span><span class="p">(</span><span class="s">"htmlToString"</span><span class="p">)</span>
<span class="k">fun</span> <span class="nc">TextView</span><span class="p">.</span><span class="nf">htmlToString</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="nc">String</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="k">if</span> <span class="p">(</span><span class="nc">Build</span><span class="p">.</span><span class="nc">VERSION</span><span class="p">.</span><span class="nc">SDK_INT</span> <span class="p">&gt;=</span> <span class="nc">Build</span><span class="p">.</span><span class="nc">VERSION_CODES</span><span class="p">.</span><span class="nc">N</span><span class="p">)</span> <span class="p">{</span>
      <span class="nc">Html</span><span class="p">.</span><span class="nf">fromHtml</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nc">Html</span><span class="p">.</span><span class="nc">FROM_HTML_MODE_LEGACY</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nd">@Suppress</span><span class="p">(</span><span class="s">"DEPRECATION"</span><span class="p">)</span>
      <span class="nc">Html</span><span class="p">.</span><span class="nf">fromHtml</span><span class="p">(</span><span class="n">text</span><span class="p">).</span><span class="nf">toString</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><li>2️⃣ FlowObserver : Flow를 Activity/Fragment 의 Lifecycler에 맞게 Observing 하기위해 만든 클래스 입니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/utils/FlowObserver.kt">깃허브</a><li>해당 포스팅에 FlowObserver에 관하여 자세히 설명했습니다. 👉🏿 <a href="https://narvis2.github.io/posts/Android-StateFlow/">StateFlow, Channel</a></ul><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c1">// FlowObserver -&gt; lifecycle 이 onStart가 되면 구독 시작, onStop이 되면 구독 취소</span>
<span class="kd">class</span> <span class="nc">FlowObserverInStop</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;(</span>
    <span class="n">lifecycleOwner</span><span class="p">:</span> <span class="nc">LifecycleOwner</span><span class="p">,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">flow</span><span class="p">:</span> <span class="nc">Flow</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;,</span>
    <span class="k">private</span> <span class="kd">val</span> <span class="py">collector</span><span class="p">:</span> <span class="k">suspend</span> <span class="p">(</span><span class="nc">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Unit</span>
<span class="p">)</span> <span class="p">{</span>

    <span class="k">private</span> <span class="kd">var</span> <span class="py">job</span><span class="p">:</span> <span class="nc">Job</span><span class="p">?</span> <span class="p">=</span> <span class="k">null</span>

    <span class="nf">init</span> <span class="p">{</span>
        <span class="n">lifecycleOwner</span><span class="p">.</span><span class="n">lifecycle</span><span class="p">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="nc">LifecycleEventObserver</span> <span class="p">{</span> <span class="n">source</span><span class="p">,</span> <span class="n">event</span> <span class="p">-&gt;</span>
            <span class="k">when</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
                <span class="nc">Lifecycle</span><span class="p">.</span><span class="nc">Event</span><span class="p">.</span><span class="nc">ON_START</span> <span class="p">-&gt;</span> <span class="p">{</span>
                    <span class="n">job</span> <span class="p">=</span> <span class="n">source</span><span class="p">.</span><span class="n">lifecycleScope</span><span class="p">.</span><span class="nf">launch</span> <span class="p">{</span>
                        <span class="n">flow</span><span class="p">.</span><span class="nf">collect</span> <span class="p">{</span>
                            <span class="nf">collector</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="nc">Lifecycle</span><span class="p">.</span><span class="nc">Event</span><span class="p">.</span><span class="nc">ON_STOP</span> <span class="p">-&gt;</span> <span class="p">{</span>
                    <span class="n">job</span><span class="o">?.</span><span class="nf">cancel</span><span class="p">()</span>
                    <span class="n">job</span> <span class="p">=</span> <span class="k">null</span>
                <span class="p">}</span>
                <span class="k">else</span> <span class="p">-&gt;</span> <span class="p">{}</span>
            <span class="p">}</span>
        <span class="p">})</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">inline</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="k">reified</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="nf">Flow</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;.</span><span class="nf">observeOnLifecycleStop</span><span class="p">(</span>
    <span class="n">lifecycleOwner</span><span class="p">:</span> <span class="nc">LifecycleOwner</span><span class="p">,</span>
    <span class="k">noinline</span> <span class="n">collector</span><span class="p">:</span> <span class="k">suspend</span> <span class="p">(</span><span class="nc">T</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nc">Unit</span>
<span class="p">)</span> <span class="p">=</span> <span class="nc">FlowObserverInStop</span><span class="p">(</span><span class="n">lifecycleOwner</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">collector</span><span class="p">)</span>

<span class="c1">// .onEach{ } 사용할때 사용</span>
<span class="k">inline</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="k">reified</span> <span class="nc">T</span><span class="p">&gt;</span> <span class="nf">Flow</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;.</span><span class="nf">observeInLifecycleStop</span><span class="p">(</span>
    <span class="n">lifecycleOwner</span><span class="p">:</span> <span class="nc">LifecycleOwner</span>
<span class="p">)</span> <span class="p">=</span> <span class="nc">FlowObserverInStop</span><span class="p">(</span><span class="n">lifecycleOwner</span><span class="p">,</span> <span class="k">this</span><span class="p">)</span> <span class="p">{}</span>
</pre></table></code></div></div><ul><li>3️⃣ Listener : 중복 클릭 방지를 위해 사용됩니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/utils/Listener.kt">깃허브</a><div class="language-kotlin highlighter-rouge"><div class="code-header"> <span data-label-text="Kotlin"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Listener</span> <span class="p">{</span>
  <span class="k">abstract</span> <span class="kd">class</span> <span class="nc">OnSingleClickListener</span><span class="p">(</span><span class="k">private</span> <span class="kd">val</span> <span class="py">minIntervalMS</span><span class="p">:</span> <span class="nc">Long</span> <span class="p">=</span> <span class="mi">1000L</span><span class="p">)</span> <span class="p">:</span> <span class="nc">View</span><span class="p">.</span><span class="nc">OnClickListener</span> <span class="p">{</span>
      <span class="c1">// 마지막으로 클릭한 시간</span>
      <span class="k">private</span> <span class="kd">var</span> <span class="py">mLastClickTime</span><span class="p">:</span> <span class="nc">Long</span> <span class="p">=</span> <span class="mi">0</span>

      <span class="k">abstract</span> <span class="k">fun</span> <span class="nf">onSingleClick</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="nc">View</span><span class="p">?)</span>

      <span class="k">override</span> <span class="k">fun</span> <span class="nf">onClick</span><span class="p">(</span><span class="n">v</span><span class="p">:</span> <span class="nc">View</span><span class="p">?)</span> <span class="p">{</span> <span class="c1">//현재 클릭한 시간</span>
          <span class="kd">val</span> <span class="py">currentClickTime</span> <span class="p">=</span> <span class="nc">SystemClock</span><span class="p">.</span><span class="nf">uptimeMillis</span><span class="p">()</span>
          <span class="c1">// 이전에 클릭한 시간과 현재시간의 차이</span>
          <span class="kd">val</span> <span class="py">elapsedTime</span> <span class="p">=</span> <span class="n">currentClickTime</span> <span class="p">-</span> <span class="n">mLastClickTime</span>
          <span class="c1">// 마지막클릭시간 업데이트</span>
          <span class="n">mLastClickTime</span> <span class="p">=</span> <span class="n">currentClickTime</span>
          <span class="c1">// 내가 정한 중복클릭시간 차이를 안넘었으면 클릭이벤트 발생못하게 return</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">elapsedTime</span> <span class="p">&lt;=</span> <span class="n">minIntervalMS</span><span class="p">)</span> <span class="k">return</span>
          <span class="c1">// 중복클릭시간 아니면 이벤트 발생</span>
          <span class="nf">onSingleClick</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><li>4️⃣ KeyboardUtils : 해당 프로젝트에서는 Keyboard가 보이지 않을때 Focus를 해제하기 위해 사용됩니다. <a href="https://github.com/narvis2/MovieSearchApp/blob/main/app/src/main/java/com/example/moviesearchapp/utils/KeyboardUtils.kt">깃허브</a><blockquote><ul><li>OnGlobalLayoutListener 을 사용하여 View 의 전체 영역이 바뀔때 Event를 받아 사용합니다.<li><strong><em>주의</em></strong> : windowSoftInputMode 에 adjustNothing 을 사용하면 View 의 변경을 알 수 없어 Listener 가 동작하지 않습니다.</ul></blockquote></ul><h2 id="마치며"><span class="mr-2">마치며</span><a href="#마치며" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>해당 포스팅는 Naver Open API를 사용하여 영화를 검색하고 검색한 영화를 사용자에게 보여주는 앱에 대하여 사용 기술에 대한 설명에 초점에 두고 작성하였습니다.<br /> 최대한 주어진 주제에 벗어나지 않는 선에서 제가 사용할 수 있는 기술을들 적용해 보았습니다.<br /> 긴 글 읽어주셔서 감사합니다.<br /> <a href="https://github.com/narvis2/MovieSearchApp">프로젝트 전체 코드</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/android/'>Android</a>, <a href='/categories/naver-open-api/'>Naver Open API</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/cleanarchitecture/" class="post-tag no-text-decoration" >cleanArchitecture</a> <a href="/tags/mvvm/" class="post-tag no-text-decoration" >MVVM</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Android+Naver+Open+API+%EC%98%81%ED%99%94+%EA%B2%80%EC%83%89+%EC%96%B4%ED%94%8C+-+Narvis2&url=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FAndroid-Clean-Architecture%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Android+Naver+Open+API+%EC%98%81%ED%99%94+%EA%B2%80%EC%83%89+%EC%96%B4%ED%94%8C+-+Narvis2&u=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FAndroid-Clean-Architecture%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FAndroid-Clean-Architecture%2F&text=Android+Naver+Open+API+%EC%98%81%ED%99%94+%EA%B2%80%EC%83%89+%EC%96%B4%ED%94%8C+-+Narvis2" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/iOS-SwiftUi-ViewModel/">iOS SwiftUi ViewModel</a><li><a href="/posts/Android-Activity-Lifecycle/">Android Activity Lifecycle 생명주기 정리</a><li><a href="/posts/Javascript-Promise-Async-Await/">JavaScript 비동기 작업 Promise, async, await 알아보기</a><li><a href="/posts/iOS-Swift-Alamofire/">iOS SwiftUi Alamofire 기초</a><li><a href="/posts/iOS-Swift-Combine-Basic/">iOS SwiftUi Combine 기초</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/react-native/">react-native</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/jetpack/">jetpack</a> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/redux/">redux</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/uikit/">UIKit</a> <a class="post-tag" href="/tags/coroutine/">coroutine</a> <a class="post-tag" href="/tags/class/">class</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Android-Activity-Lifecycle/"><div class="card-body"> <em class="small" data-ts="1657672080" data-df="YYYY-MM-DD" > 2022-07-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android Activity Lifecycle 생명주기 정리</h3><div class="text-muted small"><p> Android Activity Lifecycle 동작 순서 구글 공식 홈페이지에 나와있는 이미지를 참고하시면 이해가 쉽습니다. 해당 이미지를 참고하여 Activity Lifecycle 의 순서를 보면 Activity 생성 시 onCreate() -&amp;gt; onStart() -&amp;gt; onResume() 의 순서로 콜백이 실행 되며 Activity...</p></div></div></a></div><div class="card"> <a href="/posts/Android-Fragment-Lifecycle/"><div class="card-body"> <em class="small" data-ts="1657672080" data-df="YYYY-MM-DD" > 2022-07-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android Fragment Lifecycle 생명주기 정리</h3><div class="text-muted small"><p> 이전 Activity Lifecycle 정리 포스팅에 이어 이번에는 Fragment 의 Lifecycle에 대해 알아보겠습니다. 🚩 Android Fragment Lifecycle 동작 순서 이번에도 구글 공식 홈페이지에 나와있는 이미지를 바탕으로 살펴보겠습니다. 해당 이미지를 참고하여 Fragment Lifecycle 의 순서를 보면 Fragme...</p></div></div></a></div><div class="card"> <a href="/posts/Android-handler-looper/"><div class="card-body"> <em class="small" data-ts="1657766640" data-df="YYYY-MM-DD" > 2022-07-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Android Handler, Looper 에 관하여</h3><div class="text-muted small"><p> 이번에는 Handler, Looper 에 대해서 알아보도록 하겠습니다. Android의 UI 처리는 Single Thread Model로 동작합니다. 즉, mainThread가 아닌 다른 Thread에서 UI 를 Update하는 등의 행위를 하면 안됩니다. 따라서 mainThread를 UI Thread라고 부르기도 합니다. 동작의 무결성을 보장하기 위...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Android-Coroutine-Flow/" class="btn btn-outline-primary" prompt="이전 글"><p>Android Coroutine Flow</p></a> <a href="/posts/Android-StateFlow/" class="btn btn-outline-primary" prompt="다음 글"><p>Android StateFlow, SharedFlow, Coroutine Channel 에 대하여</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/narvis2">narvis2</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/react-native/">react-native</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/jetpack/">jetpack</a> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/redux/">redux</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/uikit/">UIKit</a> <a class="post-tag" href="/tags/coroutine/">coroutine</a> <a class="post-tag" href="/tags/class/">class</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
