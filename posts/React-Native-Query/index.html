<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="React-Native React-Query" /><meta name="author" content="Narvis2" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="안녕하세요. Narvis2 입니다. 이번 시간에는 서버의 값을 client 에 가져오거나 캐싱, 값 업데이트, 에러 핸들링 등 비동기 과정을 더욱 편하게 하는데 사용하는 react-query에 대하여 알아보겠습니다." /><meta property="og:description" content="안녕하세요. Narvis2 입니다. 이번 시간에는 서버의 값을 client 에 가져오거나 캐싱, 값 업데이트, 에러 핸들링 등 비동기 과정을 더욱 편하게 하는데 사용하는 react-query에 대하여 알아보겠습니다." /><link rel="canonical" href="https://narvis2.github.io/posts/React-Native-Query/" /><meta property="og:url" content="https://narvis2.github.io/posts/React-Native-Query/" /><meta property="og:site_name" content="Narvis2" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-27T16:19:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="React-Native React-Query" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Narvis2"},"dateModified":"2022-10-27T17:36:00+09:00","datePublished":"2022-10-27T16:19:00+09:00","description":"안녕하세요. Narvis2 입니다. 이번 시간에는 서버의 값을 client 에 가져오거나 캐싱, 값 업데이트, 에러 핸들링 등 비동기 과정을 더욱 편하게 하는데 사용하는 react-query에 대하여 알아보겠습니다.","headline":"React-Native React-Query","mainEntityOfPage":{"@type":"WebPage","@id":"https://narvis2.github.io/posts/React-Native-Query/"},"url":"https://narvis2.github.io/posts/React-Native-Query/"}</script><title>React-Native React-Query | Narvis2</title><link rel="android-chrome-192x192" sizes="192x192" href="/assets/img/favicons/android-chrome-192x192.png"><link rel="android-chrome-512x512" sizes="512x512" href="/assets/img/favicons/android-chrome-512x512.png"><link rel="mstile-150x150" sizes="150x150" href="/assets/img/favicons/mstile-150x150.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Narvis2"><meta name="application-name" content="Narvis2"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/main.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Narvis2</a></div><div class="site-subtitle font-italic">개발 일지</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/narvis2" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['narvis2','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>React-Native React-Query</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>React-Native React-Query</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1666855140" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-10-27 </em> </span> <span> 업데이트 <em class="" data-ts="1666859760" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-10-27 </em> </span><div class="d-flex justify-content-between"> <span> By <em> narvis2 </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4332 단어"> <em>24 분</em>읽는 시간</span></div></div></div><div class="post-content"><p>안녕하세요. Narvis2 입니다.<br /> 이번 시간에는 서버의 값을 client 에 가져오거나 캐싱, 값 업데이트, 에러 핸들링 등 비동기 과정을 더욱 편하게 하는데 사용하는 <code class="language-plaintext highlighter-rouge">react-query</code>에 대하여 알아보겠습니다.</p><h2 id="-react-query"><span class="mr-2">🚩 React-Query</span><a href="#-react-query" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>🍬 서버의 값을 client 에 가져오거나 Caching, value updating, error handling 등 <strong><em>비동기 과정을 더욱 편하게</em></strong> 하는데 사용됨<li>서버와 클라이언트를 분리합니다.</ul><h3 id="-1-react-query-장점"><span class="mr-2">🍀 1. React-Query 장점</span><a href="#-1-react-query-장점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>캐싱<ul><li><code class="language-plaintext highlighter-rouge">get</code>을 한 데이터에 대해 <code class="language-plaintext highlighter-rouge">update</code>를 하면 자동으로 <code class="language-plaintext highlighter-rouge">get</code>을 다시 수행한다.<li>Ex 👉 게시판의 글을 가져왔을 때 게시판의 글을 생성하면 게시판 글을 <code class="language-plaintext highlighter-rouge">get</code>하는 <code class="language-plaintext highlighter-rouge">api</code>를 자동으로 실행할 수 있음<li>데이터가 오래되었다고 판단되면 다시 <code class="language-plaintext highlighter-rouge">get</code> (<code class="language-plaintext highlighter-rouge">invalidateQueries</code>)<li>동일 데이터를 여러번 요청하면 한번만 요청한다. (Option 에 따라 중복 호출, 허용 시간 조절 가능)</ul><li>무한 스크롤<ul><li><code class="language-plaintext highlighter-rouge">Infinite Queries</code>를 사용하여 pagination 처리 가능</ul><li>비동기 과정을 선언적으로 관리가 가능하다.<li>react 의 <code class="language-plaintext highlighter-rouge">Hook</code>과 사용하는 구조가 비슷하다.</ul><h3 id="-2-usequery"><span class="mr-2">🍀 2. useQuery</span><a href="#-2-usequery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>데이터를 <code class="language-plaintext highlighter-rouge">get</code> 하기 위한 <code class="language-plaintext highlighter-rouge">api</code> (post, update 는 <code class="language-plaintext highlighter-rouge">useMutation</code> 을 사용)<li>첫 번째 파라미터<ul><li><code class="language-plaintext highlighter-rouge">Unique Key</code>가 들어감, <strong><em>요청의 결과물이 특정 변수에 따라 달라진다면</em></strong> 꼭 <code class="language-plaintext highlighter-rouge">Unique key</code>에 포함해야 함<li><code class="language-plaintext highlighter-rouge">Unique key</code>는 String 과 []을 받는다. 배열로 넘기면 0번 값은 String 값으로 다른 Component에서 부를 값이 들어가고 두 번째 값을 넣으면 Query 함수 내부에 파라미터로 해당 값이 전달됨</ul><li>두 번째 파라미터<ul><li>비동기 함수(api 호출 함수)가 들어감 (<code class="language-plaintext highlighter-rouge">promise</code>가 들어가야 함)<li>이 Component 가 랜더링될 때 해당 함수를 호출하고, 이에 대한 상태가 관리됨</ul><li>첫 번째 파라미터로 설정한 <code class="language-plaintext highlighter-rouge">Unique Key</code>는 다른 Component 에서도 해당 <code class="language-plaintext highlighter-rouge">key</code>를 사용하면 호출 가능<li><code class="language-plaintext highlighter-rouge">Return</code> 값<ul><li>Api 요청의 성공, 실패 여부 및 Api 결과 값을 포함한 객체<li><blockquote><p><code class="language-plaintext highlighter-rouge">status</code> 👉 API의 요청 상태를 문자열로 나타냄</p></blockquote><ul><li><blockquote><p><code class="language-plaintext highlighter-rouge">loading</code> 👉 아직 데이터를 받아오지 않고, 현재 데이터를 요청 중</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">error</code> 👉 오류 발생</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">success</code> 👉 데이터 요청 성공</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">idle</code> 👉 비활성화된 상태(따로 설정해 비활성화한 경우)</p></blockquote></ul><li><blockquote><p><code class="language-plaintext highlighter-rouge">isLoading</code> 👉 status === ‘loading’ 과 같음</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">isError</code> 👉 status === ‘error’ 와 같음</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">isSuccess</code> 👉 staus === ‘success’ 와 같음</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">isIdle</code> 👉 staus === ‘idle’ 과 같음</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">error</code> 👉 오류가 발생했을 때 오류 정보를 가지고 있음</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">data</code> 👉 요청 성공한 데이터를 가리킴</p></blockquote><li><blockquote><p><code class="language-plaintext highlighter-rouge">isFetching</code> 👉 데이터가 요청 중일 때 true가 됨</p></blockquote><ul><li><blockquote><p>데이터가 이미 존재하는 상태에서 재요청할 때 <code class="language-plaintext highlighter-rouge">isLoading</code> 은 false 이지만, <code class="language-plaintext highlighter-rouge">isFetching</code> 은 true 임</p></blockquote></ul><li><blockquote><p><code class="language-plaintext highlighter-rouge">refetch</code> 👉 다시 요청을 시작하는 함수</p></blockquote></ul><li>비동기로 작동<ul><li>여러개의 비동기 <code class="language-plaintext highlighter-rouge">Query</code>가 있다면 <code class="language-plaintext highlighter-rouge">useQuery</code> 보다는 <code class="language-plaintext highlighter-rouge">useQueries</code> 를 사용하는 것이 좋음</ul><li><code class="language-plaintext highlighter-rouge">enabled</code> 를 사용하면 <code class="language-plaintext highlighter-rouge">useQuery</code> 를 동기적으로 사용 가능<ul><li><code class="language-plaintext highlighter-rouge">useQuery</code>의 3번째 인자로 <code class="language-plaintext highlighter-rouge">Option</code> 값이 들어가는데 그 <code class="language-plaintext highlighter-rouge">Option</code>의 <code class="language-plaintext highlighter-rouge">enabled</code>에 값을 넣으면 <code class="language-plaintext highlighter-rouge">enabled</code> 값이 <code class="language-plaintext highlighter-rouge">true</code> 일때 <code class="language-plaintext highlighter-rouge">useQuery</code>를 실행함</ul><li><code class="language-plaintext highlighter-rouge">useQuery Option</code><ul><li><code class="language-plaintext highlighter-rouge">enable</code> 👉 boolean 타입의 값을 설정, 이 값이 false 이면 Component 가 마운트될 때 자동으로 요청하지 않음. <strong><em>refetch 함수로만 요청이 시작됨</em></strong><li><code class="language-plaintext highlighter-rouge">retry</code> 👉 boolean or number or (failureCount: number, error: TError) =&gt; boolean 타입의 값을 설정<ul><li>요청이 실패했을 때 재요청할지 설정할 수 있음<li><blockquote><p>이 값을 <code class="language-plaintext highlighter-rouge">true</code>로 했을때 👉 실패했을 때 성공할 때까지 계속 반복 요청</p></blockquote><li><blockquote><p>이 값을 <code class="language-plaintext highlighter-rouge">false</code>로 했을때 👉 실패했을 떄 재요청하지 않음</p></blockquote><li><blockquote><p>이 값을 <code class="language-plaintext highlighter-rouge">3</code> 으로 하면 👉 3번까지만 재요청</p></blockquote><li><blockquote><p>이 값을 <code class="language-plaintext highlighter-rouge">함수 타입</code>으로 설정하면 👉 실패 횟수와 오류 타입에 따라 재요청할지 함수 내에서 결정할 수 있음</p></blockquote></ul><li><code class="language-plaintext highlighter-rouge">retryDelay</code> 👉 number or (retryAttempt: number, error: TError) =&gt; number 타입 값을 설정<ul><li>시간 단위는 ms(밀리세컨드 0.001초)임<li><blockquote><p>기본값 👉 (retryAttempt) =&gt; Math.min(1000 * 2 ** failureCount, 30000)</p></blockquote><li><blockquote><p>실패 횟수 n 에 따라 2의 n 제곱 초만큼 기다렸다가 재요청하고 최대 30초까지 기다림</p></blockquote></ul><li><code class="language-plaintext highlighter-rouge">staleTime</code> 👉 데이터의 유효 시간을 ms 단위로 설정, 기본값 0 (데이터를 조회한 순간 데이터는 바로 유효하지 않게 됨)<li><code class="language-plaintext highlighter-rouge">cacheTime</code> 👉 데이터의 캐시 시간을 ms 단위로 설정, 기본값은 5분, 캐시 시간은 Hook을 사용하는 Component 가 언마운트되고 나서 해당 데이터를 얼마나 유지할지 결정함<blockquote><p><strong><em>🍀 참고 🍀</em></strong> <code class="language-plaintext highlighter-rouge">staleTime</code> 과 <code class="language-plaintext highlighter-rouge">cacheTime</code> 의 차이 👇</p><ul><li><code class="language-plaintext highlighter-rouge">useQuery</code> 를 사용할 때 <code class="language-plaintext highlighter-rouge">staleTime</code> 옵션은 기본값이 0 임. 즉, <strong><em>데이터를 조회한 순간 데이터는 바로 유효하지 않게됨</em></strong>. 데이터가 유효하지 않다면 기회가 주어졌을 때 다시 요청하여 데이터를 최신화 해야함<li>재요청 기회가 주어지는 시점 : 똑같은 <code class="language-plaintext highlighter-rouge">Cache key</code> 를 사용하는 <code class="language-plaintext highlighter-rouge">useQuery</code> 를 사용중인 Component 가 마운트될 때<li><code class="language-plaintext highlighter-rouge">cacheTime</code>은 <code class="language-plaintext highlighter-rouge">useQuery Hook</code>을 사용한 Component가 언마운트되고 나서 해당 데이터를 얼마 동안 유지할지에 대한 설정, 기본값은 5<li>만약 <code class="language-plaintext highlighter-rouge">useQuery</code>를 사용한 Component 가 언마운트되고 나서 5분안에 다시 마운트된다면 isLoading 값이 true로 되지 않고, 처음 렌더링하는 시점부터 data 값이 이전에 불러온 데이터로 채워져 있게 된다. 그리고 <code class="language-plaintext highlighter-rouge">staleTime</code>에 따라 해당 데이터가 유효하다면 재요청하지 않고, 유효하지 않다면 재요청한다.</ul></blockquote><li><code class="language-plaintext highlighter-rouge">refetchInterval</code> 👉 false or number 타입값을 설정<ul><li>이 설정으로 n초마다 데이터를 새로고침하도록 설정할 수 있음<li>시간 단위는 ms 임</ul><li><code class="language-plaintext highlighter-rouge">refetchOnmount</code> 👉 boolean or ‘always’ 타입의 값을 설정<ul><li>이 설정으로 Component가 마운트될 때 재요청하는 방식을 설정할 수 있음<li><blockquote><p>기본 값: true</p></blockquote><li><blockquote><p>true일 때는 데이터가 유효하지 않을 때 재요청함</p></blockquote><li><blockquote><p>false일 때는 Component가 다시 마운트되어도 재요청하지 않음</p></blockquote><li><blockquote><p>‘always’일 때는 데이터의 유효 여부와 관계없이 무조건 재요청함</p></blockquote></ul><li><code class="language-plaintext highlighter-rouge">onSuccess</code> 👉 (data: Data) =&gt; void 타입의 함수를 설정, 데이터 요청이 성공하고 나서 특정 함수를 호출하고 싶을 때 사용<li><code class="language-plaintext highlighter-rouge">onError</code> 👉 (error: Error) =&gt; void 타입의 함수를 설정, 데이터 요청이 실패하고 나서 특정 함수를 호출하고 싶을 때 사용<li><code class="language-plaintext highlighter-rouge">onSettled</code> 👉 (data?: Data, error?: Error) =&gt; void 타입의 함수를 설정, 데이터 요청의 성공 여부와 관계없이 요청이 끝나면 특정 함수를 호출하도록 설정<li><div class="table-wrapper"><table><tbody><tr><td><code class="language-plaintext highlighter-rouge">initialData</code> 👉 Data<td>() =&gt; Data 타입의 값을 설정, <code class="language-plaintext highlighter-rouge">Hook</code> 에서 사용할 데이터의 초깃값을 지정하고 싶을 때 사용</table></div><li><code class="language-plaintext highlighter-rouge">refetchOnWindowFocus</code> 👉 <code class="language-plaintext highlighter-rouge">React-Query</code>는 사용자가 사용하는 윈도우가 다른 곳을 갔다가 다시 화면으로 돌아오면 이 함수를 재실행함, 그 재실행 여부 옵션</ul></ul><blockquote><p><strong><em>예제 👇</em></strong> 기본 설정 &gt; index.js 에 작성</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">QueryClient</span><span class="p">,</span> <span class="nx">QueryClientProvider</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-query</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">ReactQueryDevtools</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react-query/devtools</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryClient</span><span class="p">();</span>
<span class="kd">const</span> <span class="nx">root</span> <span class="o">=</span> <span class="nx">ReactDOM</span><span class="p">.</span><span class="nf">createRoot</span><span class="p">(</span><span class="nx">documnet</span><span class="p">.</span><span class="nf">getElementById</span><span class="p">(</span><span class="dl">"</span><span class="s2">root</span><span class="dl">"</span><span class="p">));</span>

<span class="nx">root</span><span class="p">.</span><span class="nc">Render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">React</span><span class="p">.</span><span class="nx">StrictMode</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">QueryClientProvider</span> <span class="nx">client</span><span class="o">=</span><span class="p">{</span><span class="nx">queryClient</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">ReactQueryDevtools</span> <span class="nx">initialIsOpen</span><span class="o">=</span><span class="p">{</span><span class="kc">true</span><span class="p">}</span> <span class="sr">/</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/QueryClientProvider</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/React.StrictMode</span><span class="err">&gt;
</span><span class="p">);</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useQuery</code> 사용</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">isLoading</span><span class="p">,</span> <span class="nx">isError</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">error</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useQuery</span><span class="p">(</span><span class="dl">"</span><span class="s2">todos</span><span class="dl">"</span><span class="p">,</span> <span class="nx">fetchTodoList</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">refetchOnWindowFocus</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">retry</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">onError</span><span class="p">:</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">},</span>
  <span class="p">});</span>

  <span class="nf">if </span><span class="p">(</span><span class="nx">isLoading</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return </span><span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="dl">"</span><span class="s2">Loading</span><span class="dl">"</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>

  <span class="nf">if </span><span class="p">(</span><span class="nx">isError</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return </span><span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">View</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Text</span><span class="o">&gt;</span><span class="p">{</span><span class="dl">"</span><span class="s2">에러</span><span class="dl">"</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/Text</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/View</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Something...</span>
<span class="p">};</span>
</pre></table></code></div></div><h3 id="-3-usequeries"><span class="mr-2">🍀 3. useQueries</span><a href="#-3-usequeries" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">useQuery</code>를 비동기로 여러개 실행할 경우 사용<li><code class="language-plaintext highlighter-rouge">promise.all</code>과 마찬가지로 하나의 배열에 각 <code class="language-plaintext highlighter-rouge">Query</code>에 대한 상태 값이 객체로 들어옴</ul><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useQueries</code> 사용 (lol 룬과 스펠을 받아오는 예시)</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nf">useQueries</span><span class="p">([</span>
  <span class="cm">/**
   * getRune -&gt; Unique Key
   * riot.version -&gt; 파라미터
   */</span>
  <span class="p">{</span>
    <span class="na">queryKey</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">getRune</span><span class="dl">"</span><span class="p">,</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">],</span>
    <span class="na">queryFn</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">api</span><span class="p">.</span><span class="nf">getRunInfo</span><span class="p">(</span><span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">),</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">queryKey</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">getSpell</span><span class="dl">"</span><span class="p">,</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">],</span>
    <span class="na">queryFn</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">api</span><span class="p">.</span><span class="nf">getSpellInfo</span><span class="p">(</span><span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">),</span>
  <span class="p">},</span>
<span class="p">]);</span>

<span class="nf">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">loadingFinishAll</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nf">some</span><span class="p">((</span><span class="nx">result</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">result</span><span class="p">.</span><span class="nx">isLoading</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">loadingFinishAll</span><span class="p">);</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">result</span><span class="p">]);</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useQueries</code> 사용 &gt; <code class="language-plaintext highlighter-rouge">Unique Key</code> 활용 &gt; <code class="language-plaintext highlighter-rouge">Unique Key</code>를 배열로 넣으면 <code class="language-plaintext highlighter-rouge">queryFn(쿼리 함수)</code> 내부에서 변수로 사용 가능</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nf">useQueries</span><span class="p">([</span>
  <span class="p">{</span>
    <span class="na">queryKey</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">getRune</span><span class="dl">"</span><span class="p">,</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">],</span>
    <span class="na">queryFn</span><span class="p">:</span> <span class="p">(</span><span class="nx">params</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// 결과 -&gt; {queryKey: ['getRune', '12.1.1'], pageParam: undifined, meta: undifined}</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="nx">params</span><span class="p">);</span>
      <span class="k">return</span> <span class="nx">api</span><span class="p">.</span><span class="nf">getRunInfo</span><span class="p">(</span><span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">);</span>
    <span class="p">},</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="na">queryKey</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">getSpell</span><span class="dl">"</span><span class="p">,</span> <span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">],</span>
    <span class="na">queryFn</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">api</span><span class="p">.</span><span class="nf">getSpellInfo</span><span class="p">(</span><span class="nx">riot</span><span class="p">.</span><span class="nx">version</span><span class="p">),</span>
  <span class="p">},</span>
<span class="p">]);</span>
</pre></table></code></div></div><h3 id="-4-usemutation"><span class="mr-2">🍀 4. useMutation</span><a href="#-4-usemutation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>값을 바꿀 때 사용하는 api<li>데이터를 생성(<code class="language-plaintext highlighter-rouge">POST</code>), 수정(<code class="language-plaintext highlighter-rouge">UPDATE</code>), 삭제(<code class="language-plaintext highlighter-rouge">DELETE</code>)할 떄 사용하는 <code class="language-plaintext highlighter-rouge">Hook</code><li><strong><em>특정 함수에서 우리가 원하는 때에 직접 요청을 시작하는 형태</em></strong><li>요청 관련 상태의 관리와 요청 처리 전/후로 실행할 작업을 쉽게 설정할 수 있음<li>첫 번쨰 인자 👉 <code class="language-plaintext highlighter-rouge">Promise</code>를 반환하는 함수<li>두 번째 인자 👉 <strong><em>이 작업이 처리되기 전후로 실행할 함수를 넣음</em></strong>(생략가능)<blockquote><ul><li>onMutate 👉 요청 직전 처리, 여기서 반환하는 값은 하단 함수들의 context로 사용<li>onError 👉 데이터 요청이 실패하고 나서 특정 함수를 호출하고 싶을 때 사용<li>onSuccess 👉 데이터 요청이 성공하고 나서 특정 함수를 호출하고 싶을 때 사용<li>onSettled 👉 데이터 요청의 성공 여부와 관계없이 요청이 끝나면 특정 함수를 호출하도록 설정</ul></blockquote><li><code class="language-plaintext highlighter-rouge">return</code> 값 👉 <code class="language-plaintext highlighter-rouge">useQuery</code> 와 동일<ul><li><code class="language-plaintext highlighter-rouge">mutate</code> 👇<blockquote><ul><li>요청을 시작하는 함수<li>첫 번째 인자 👉 API 함수에서 사용할 인자<li>두 번쨰 인자<li>{onSuccess, onSettled, onError} 객체, (생략가능)<li>option 에 설정된 함수가 먼저 호출되고, mutate 두 번째 파라미터에 넣은 함수가 호출됨</ul></blockquote><li><code class="language-plaintext highlighter-rouge">mutateAsync</code> 👉 <code class="language-plaintext highlighter-rouge">mutate</code>와 인자는 동일, 함수를 호출했을 때 반환 값이 <code class="language-plaintext highlighter-rouge">Primse</code><li><code class="language-plaintext highlighter-rouge">staus</code> 👉 요청 상태를 문자열로 변환(idle, loading, error, success)<li><code class="language-plaintext highlighter-rouge">error</code> 👉 오류 정보<li><code class="language-plaintext highlighter-rouge">data</code> 👉 요청 성공 시 데이터가 담겨있음<li><code class="language-plaintext highlighter-rouge">reset</code> 👉 <strong><em>상태를 모두 초기화하는 함수</em></strong></ul></ul><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useMutation</code> 사용</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">Index</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">id</span><span class="p">,</span> <span class="nx">setId</span><span class="p">]</span> <span class="o">=</span> <span class="nf">useState</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
  <span class="kd">const</span> <span class="p">[</span><span class="nx">password</span><span class="p">,</span> <span class="nx">setPassword</span><span class="p">]</span> <span class="o">=</span> <span class="nf">useState</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">loginMutation</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">loginApi</span><span class="p">,</span> <span class="p">{</span>
    <span class="c1">// variable -&gt; {loginId: xxx, password: xxx}</span>
    <span class="na">onMutate</span><span class="p">:</span> <span class="nx">variable</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">onMutate</span><span class="dl">"</span><span class="p">,</span> <span class="nx">variable</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">onError</span><span class="p">:</span> <span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">variable</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="c1">// TODO: Error 핸들링</span>
    <span class="p">},</span>
    <span class="na">onSuccess</span><span class="p">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">variables</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">varibles</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="na">onSettled</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">end);
    },
  });

    // API 호출에 사용될 인자
  const onSubmit = () =&gt; {
    loginMutation.mutate({loginId: id, password: password});
  }
}
</span></pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">invalidateQueries</code>를 사용하여 UPDATE 후 GET 함수를 간단하게 실행<br /> <code class="language-plaintext highlighter-rouge">mutation</code> 함수가 성공할 때, <code class="language-plaintext highlighter-rouge">unique key</code>로 맵핑된 <code class="language-plaintext highlighter-rouge">GET</code>함수를 <code class="language-plaintext highlighter-rouge">invalidateQueries</code>에 넣어주면 됨<br /> <strong><em>만약 <code class="language-plaintext highlighter-rouge">mutation</code>에서 <code class="language-plaintext highlighter-rouge">return</code>된 값을 이용해서 <code class="language-plaintext highlighter-rouge">GET</code>함수의 파라미터를 변경해야 할 경우 <code class="language-plaintext highlighter-rouge">setQueryData</code>를 사용</em></strong></p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">mutation</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">postTodo</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="c1">// postTodo 가 성공하면 todos 로 맵핑된 useQuery API 함수를 실행</span>
    <span class="nx">queryClient</span><span class="p">.</span><span class="nf">invalidateQueries</span><span class="p">(</span><span class="dl">"</span><span class="s2">todos</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="c1">// 만약 mutation에서 return된 값을 이용해서 GET 함수의 파라미터를 변경해야할 경우 setQueryData를 사용</span>
<span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="nf">useQueryClient</span><span class="p">();</span>

<span class="c1">// data 가 fetchTodoById 로 들어감</span>
<span class="kd">const</span> <span class="nx">mutation</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">editTodo</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">queryClient</span><span class="p">.</span><span class="nf">setQueryData</span><span class="p">([</span><span class="dl">"</span><span class="s2">todo</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}],</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="p">{</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">error</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useQuery</span><span class="p">([</span><span class="dl">"</span><span class="s2">todo</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}],</span> <span class="nx">fetchTodoById</span><span class="p">);</span>

<span class="nx">mutation</span><span class="p">.</span><span class="nf">mutate</span><span class="p">({</span>
  <span class="na">id</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">nkh</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>
</pre></table></code></div></div><h3 id="-5-react-suspense-와-react-query-사용"><span class="mr-2">🍀 5. react-suspense 와 react-query 사용</span><a href="#-5-react-suspense-와-react-query-사용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>비동기를 좀 더 선언적으로 사용할 수 있음.<li><code class="language-plaintext highlighter-rouge">suspense</code> 를 사용하여 <code class="language-plaintext highlighter-rouge">loading</code> 을, <code class="language-plaintext highlighter-rouge">Error bundary</code>를 사용하여 <code class="language-plaintext highlighter-rouge">error handling</code>을 더욱 직관적으로 할 수 있음.<li><code class="language-plaintext highlighter-rouge">suspense</code> 를 사용하기 위해 <code class="language-plaintext highlighter-rouge">QueryClient</code> 에 <code class="language-plaintext highlighter-rouge">option</code> 을 하나 추가해야 함</ul><blockquote><p><strong><em>예제 👇</em></strong> Global 하게 <code class="language-plaintext highlighter-rouge">suspense</code> 를 사용한다고 정의 &gt; src/index.js 에 선언</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">QueryClient</span><span class="p">({</span>
  <span class="na">defaultOptions</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">queries</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">retry</span><span class="p">:</span> <span class="mi">0</span>
      <span class="na">suspense</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">})</span>

<span class="nx">ReactDom</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">React</span><span class="p">.</span><span class="nx">StrictMode</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">QueryClientProvider</span> <span class="nx">client</span><span class="o">=</span><span class="p">{</span><span class="nx">queryClient</span><span class="p">}</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="sr">/QueryClientProvider</span><span class="err">&gt;
</span>  <span class="p">...</span>
<span class="p">)</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> 함수마다 <code class="language-plaintext highlighter-rouge">suspense</code>를 사용하는 예시</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="p">{</span> <span class="nx">data</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useQuery</span><span class="p">(</span><span class="dl">"</span><span class="s2">test</span><span class="dl">"</span><span class="p">,</span> <span class="nx">testApi</span><span class="p">,</span> <span class="p">{</span> <span class="na">suspense</span><span class="p">:</span> <span class="nx">ture</span> <span class="p">});</span>

<span class="nf">return </span><span class="p">(</span>
  <span class="o">&lt;</span><span class="nx">Suspense</span> <span class="nx">fallback</span><span class="o">=</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span> <span class="nx">loading</span><span class="p">...</span> <span class="o">&lt;</span><span class="sr">/div&gt;}</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">ErrorBoundary</span> <span class="nx">fallback</span><span class="o">=</span><span class="p">{</span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">에러발생</span><span class="o">&lt;</span><span class="sr">/div&gt;}</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">data</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/ErrorBoundary</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/Suspense</span><span class="err">&gt;
</span><span class="p">);</span>
</pre></table></code></div></div><h3 id="-6-react-query-cache-데이터-새로고침"><span class="mr-2">🍀 6. React-Query Cache 데이터 새로고침</span><a href="#-6-react-query-cache-데이터-새로고침" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">React-Query</code>에는 <code class="language-plaintext highlighter-rouge">useQuery</code>를 사용할 때 입력한 <code class="language-plaintext highlighter-rouge">Unique Key</code>를 통해 데이터를 만료시키고, 새로 불러올 수 있도록 처리할 수 있다.<li><code class="language-plaintext highlighter-rouge">invalidateQueries</code> 👇<ul><li>캐시를 만료시켜 데이터를 새로 고침<li><code class="language-plaintext highlighter-rouge">Unique Key</code>를 사용하여 데이터를 만료시키고, API를 재요청하는 방식</ul><li><code class="language-plaintext highlighter-rouge">useQueryClient</code> 👉 이 <code class="language-plaintext highlighter-rouge">Hook</code>은 이전에 <code class="language-plaintext highlighter-rouge">App Component</code>에서 <code class="language-plaintext highlighter-rouge">QueryClientProvider</code>에 넣었던 <code class="language-plaintext highlighter-rouge">queryClient</code>를 사용할 수 있게 해줌<ul><li><code class="language-plaintext highlighter-rouge">getQueryData</code> 👇<blockquote><ul><li><code class="language-plaintext highlighter-rouge">Unique Key</code>를 사용하여 Cache Data 를 조회할 수 있음<li>데이터가 <code class="language-plaintext highlighter-rouge">undifined</code>일 수 있으니, 만약 데이터가 존재하지 않는다면 <code class="language-plaintext highlighter-rouge">빈 배열</code>을 사용하도록 준비<li><code class="language-plaintext highlighter-rouge">TypeScript</code> 환경에서는 <code class="language-plaintext highlighter-rouge">Generic</code>을 지정하면 반환값의 데이터 type 을 설정할 수 있음</ul></blockquote><li><code class="language-plaintext highlighter-rouge">setQueryData</code> 👇<blockquote><ul><li>Cache Data 를 업데이트하는 메서드<li>데이터를 두 번째 인자에 넣어도되고, <code class="language-plaintext highlighter-rouge">업데이트 함수</code>형태의 값을 인자로 넣을 수 있음<li>만약 <code class="language-plaintext highlighter-rouge">업데이트 함수</code> 형태로 넣는다면 <code class="language-plaintext highlighter-rouge">getQueryData</code>는 생략 가능</ul></blockquote></ul></ul><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">QueryClient</code>를 사용하여 데이터 새로고침</p><blockquote></blockquote></blockquote><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="nf">useQueryClient</span><span class="p">();</span>

<span class="kd">const</span> <span class="p">{</span> <span class="na">mutate</span><span class="p">:</span> <span class="nx">write</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">writerArticle</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">queryClient</span><span class="p">.</span><span class="nf">invalidateQueries</span><span class="p">(</span><span class="dl">"</span><span class="s2">articles</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">navigation</span><span class="p">.</span><span class="nf">goBack</span><span class="p">();</span>
  <span class="p">},</span>
<span class="p">});</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">QueryClient</code>로 <code class="language-plaintext highlighter-rouge">Cache Data</code>를 직접 <code class="language-plaintext highlighter-rouge">UPDATE</code>하기<br /> <strong><em>API를 재요청하지 않고 <code class="language-plaintext highlighter-rouge">Cache Data</code>를 <code class="language-plaintext highlighter-rouge">UPDATE</code></em></strong></p><blockquote></blockquote></blockquote><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="nf">useQueryClient</span><span class="p">();</span>

<span class="kd">const</span> <span class="p">{</span> <span class="na">mutate</span><span class="p">:</span> <span class="nx">write</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">writeArticle</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="p">(</span><span class="nx">article</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">articles</span> <span class="o">=</span> <span class="nx">queryClient</span><span class="p">.</span><span class="nx">getQueryData</span><span class="o">&lt;</span><span class="nx">Article</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">"</span><span class="s2">articles</span><span class="dl">"</span><span class="p">)</span> <span class="o">??</span> <span class="p">[];</span>
    <span class="nx">queryClient</span><span class="p">.</span><span class="nf">setQueryData</span><span class="p">(</span><span class="dl">"</span><span class="s2">articles</span><span class="dl">"</span><span class="p">,</span> <span class="nx">articles</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="nx">article</span><span class="p">));</span>
  <span class="p">},</span>
<span class="p">});</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">getQueryData</code> 생략, <code class="language-plaintext highlighter-rouge">UPDATE</code> 함수 형태의 값을 인자로 넣음<br /> <code class="language-plaintext highlighter-rouge">Unique Key</code>로 데이터 조회 후 그 데이터를 <code class="language-plaintext highlighter-rouge">UPDATE</code> 함수를 사용하여 <code class="language-plaintext highlighter-rouge">UPDATE</code></p><blockquote></blockquote></blockquote><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">queryClient</span> <span class="o">=</span> <span class="nf">useQueryClient</span><span class="p">();</span>

<span class="kd">const</span> <span class="p">{</span> <span class="na">mutate</span><span class="p">:</span> <span class="nx">write</span> <span class="p">}</span> <span class="o">=</span> <span class="nf">useMutation</span><span class="p">(</span><span class="nx">writeArticle</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">onSuccess</span><span class="p">:</span> <span class="p">(</span><span class="nx">article</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">queryClient</span><span class="p">.</span><span class="nx">setQueryData</span><span class="o">&lt;</span><span class="nx">Article</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">(</span><span class="dl">"</span><span class="s2">articles</span><span class="dl">"</span><span class="p">,</span> <span class="p">(</span><span class="nx">articles</span><span class="p">)</span> <span class="o">=&gt;</span>
      <span class="p">(</span><span class="nx">articles</span> <span class="o">??</span> <span class="p">[]).</span><span class="nf">concat</span><span class="p">(</span><span class="nx">article</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">},</span>
<span class="p">});</span>
</pre></table></code></div></div><h3 id="-7-useinfinitequery"><span class="mr-2">🍀 7. useInfiniteQuery</span><a href="#-7-useinfinitequery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><code class="language-plaintext highlighter-rouge">React-Query</code>에서 <code class="language-plaintext highlighter-rouge">Pagenation</code>을 구현할 때 사용<li>함수 부분에서 <code class="language-plaintext highlighter-rouge">pageParam</code>을 사용하고, <code class="language-plaintext highlighter-rouge">option</code>부분에 <code class="language-plaintext highlighter-rouge">getNextPageParam</code>을 설정해줘야 함<li><code class="language-plaintext highlighter-rouge">getNextPageParam</code> 👉 (lastPage, allPages) =&gt; unknown | undefined 타입 함수<blockquote><ul><li>이 함수에서는 <code class="language-plaintext highlighter-rouge">pageParam</code>으로 사용할 값을 결정<li><code class="language-plaintext highlighter-rouge">getNextPageParam</code> 에서 더 이상 조회할 수 있는 데이터가 없는 경우 <code class="language-plaintext highlighter-rouge">undefined</code> 를 반환해야 함<li><code class="language-plaintext highlighter-rouge">allPages</code> 👉 지금까지 불러온 모든 페이지를 가리킴, 배열로 이루어진 배열 ex) Article[][]<li><code class="language-plaintext highlighter-rouge">lastPage</code> 👉 가장 마지막으로 불러온 페이지, 현재 data type ex) Article[]</ul></blockquote><li><code class="language-plaintext highlighter-rouge">return</code> 값<blockquote><ul><li><code class="language-plaintext highlighter-rouge">data</code> 👉 {pageParams, pages} 타입을 가지고 있음<li><code class="language-plaintext highlighter-rouge">pageParams</code> 👉 각 페이지에서 사용된 파라미터 배열<li><code class="language-plaintext highlighter-rouge">pages</code> 👉 각 페이지들을 배열 타입으로 나타냄 ex) Article[][]<li><code class="language-plaintext highlighter-rouge">fetchNextPage</code> 👉 다음 페이지를 불러오는 함수<li><code class="language-plaintext highlighter-rouge">hasNextPage</code> 👉 다음 페이지의 <strong><em>존재 유무</em></strong>를 알려줌 만약 <code class="language-plaintext highlighter-rouge">getNextPageParam</code> 에서 <code class="language-plaintext highlighter-rouge">undefined</code> 를 반환했다면 이 값은 <code class="language-plaintext highlighter-rouge">false</code>가 되고 그렇지 않으면 <code class="language-plaintext highlighter-rouge">true</code>가 된다.<li><code class="language-plaintext highlighter-rouge">isFetchingNextPage</code> 👉 <strong><em>다음 페이지를 불러오고 있는지</em></strong> 여부를 알려줌<li>그 외에 <code class="language-plaintext highlighter-rouge">useQuery</code>에서 반환되는 모든 필드들이 존재</ul></blockquote></ul><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useInfiniteQuery</code> 사용</p><blockquote></blockquote></blockquote><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">ArticlesScreen</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span><span class="nx">data</span><span class="p">,</span> <span class="nx">isFetchingNextPage</span><span class="p">,</span> <span class="nx">fetchNextPage</span><span class="p">}</span> <span class="o">=</span> <span class="nf">useInfiniteQuery</span><span class="p">(</span>
    <span class="dl">'</span><span class="s1">articles</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">({</span><span class="nx">pageParam</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="nf">getArticle</span><span class="p">({</span><span class="na">cursor</span><span class="p">:</span> <span class="nx">pageParam</span><span class="p">}),</span>
    <span class="p">{</span>
      <span class="na">getNextPageParam</span><span class="p">:</span> <span class="p">(</span><span class="nx">lastPage</span><span class="p">)</span> <span class="o">=&gt;</span>
        <span class="nx">lastPage</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">10</span> <span class="p">?</span> <span class="nx">lastPage</span><span class="p">[</span><span class="nx">lastPage</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">id</span> <span class="p">:</span> <span class="kc">undefined</span><span class="p">,</span>
    <span class="p">},</span>
  <span class="p">);</span>

  <span class="cm">/**
   * [][] =&gt; [] 으로 변경
   * [] as Aritlce[] 이라고 입력하여 해당 배열이 Article의 배열이란 것을 명시하고, concat을 해줌
   * concat 에는 배열 타입을 넣으면 해당 배열을 해체해서 앞부분의 배열에 붙여주기 때문에, 해당 방식으로
   * 하면 배열들이 하나의 배열로 합쳐짐
   */</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="nf">useMemo</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="nf">return </span><span class="p">([]</span> <span class="k">as</span> <span class="nx">Article</span><span class="p">[]).</span><span class="nf">concat</span><span class="p">(...</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">data</span><span class="p">]);</span>

  <span class="kd">const</span> <span class="p">[</span><span class="nx">user</span><span class="p">]</span> <span class="o">=</span> <span class="nf">useUserState</span><span class="p">();</span>

  <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">return </span><span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">ActivityIndicator</span> <span class="nx">size</span><span class="o">=</span><span class="dl">"</span><span class="s2">large</span><span class="dl">"</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">spinner</span><span class="p">}</span> <span class="nx">color</span><span class="o">=</span><span class="dl">"</span><span class="s2">black</span><span class="dl">"</span><span class="o">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="nf">return </span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Articles</span>
      <span class="nx">articles</span><span class="o">=</span><span class="p">{</span><span class="nx">items</span><span class="p">}</span>
      <span class="nx">showWriteButton</span><span class="o">=</span><span class="p">{</span><span class="o">!!</span><span class="nx">user</span><span class="p">}</span>
      <span class="nx">isFetchingNextPage</span><span class="o">=</span><span class="p">{</span><span class="nx">isFetchingNextPage</span><span class="p">}</span>
      <span class="nx">fetchNextPage</span><span class="o">=</span><span class="p">{</span><span class="nx">fetchNextPage</span><span class="p">}</span>
    <span class="o">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote><p><strong><em>예제 👇</em></strong> <code class="language-plaintext highlighter-rouge">useInfiniteQuery</code> 사용 &gt; <code class="language-plaintext highlighter-rouge">FlatList</code> 연결</p><blockquote></blockquote></blockquote><div class="language-typescript highlighter-rouge"><div class="code-header"> <span data-label-text="TypeScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="kr">interface</span> <span class="nx">ArticlesProps</span> <span class="p">{</span>
  <span class="nl">articles</span><span class="p">:</span> <span class="nx">Article</span><span class="p">[];</span>
  <span class="nl">showWriteButton</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nl">isFetchingNextPage</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>
  <span class="nf">fetchNextPage</span><span class="p">():</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nc">Articles</span><span class="p">({</span>
  <span class="nx">articles</span><span class="p">,</span>
  <span class="nx">showWriteButton</span><span class="p">,</span>
  <span class="nx">isFetchingNextPage</span><span class="p">,</span>
  <span class="nx">fetchNextPage</span>
<span class="p">}:</span> <span class="nx">ArticlesProps</span><span class="p">)</span> <span class="p">{</span>
  <span class="nf">return </span><span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">FlatList</span>
      <span class="nx">data</span><span class="o">=</span><span class="p">{</span><span class="nx">articles</span><span class="p">}</span>
      <span class="nx">renderItem</span><span class="o">=</span><span class="p">{({</span><span class="nx">item</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">ArticleItem</span>
          <span class="nx">id</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
          <span class="nx">title</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
          <span class="nx">publishedAt</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">published_at</span><span class="p">}</span>
          <span class="nx">username</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">)}</span>
      <span class="nx">keyExtractor</span><span class="o">=</span><span class="p">{(</span><span class="nx">item</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nf">toString</span><span class="p">()}</span>
      <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">list</span><span class="p">}</span>
      <span class="nx">ItemSeparatorComponent</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">separator</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">}
</span>      <span class="nx">ListHeaderComponent</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">showWriteButton</span> <span class="p">?</span> <span class="o">&lt;</span><span class="nx">WriteButton</span> <span class="o">/&gt;</span> <span class="p">:</span> <span class="kc">null</span><span class="p">)}</span>
      <span class="nx">ListFooterComponent</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="p">(</span>
        <span class="o">&lt;&gt;</span>
          <span class="p">{</span><span class="nx">articles</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">?</span> <span class="o">&lt;</span><span class="nx">View</span> <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">separator</span><span class="p">}</span> <span class="sr">/&gt; : null</span><span class="err">}
</span>          <span class="p">{</span><span class="nx">isFetchingNextPage</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">ActivityIndicator</span>
              <span class="nx">size</span><span class="o">=</span><span class="dl">"</span><span class="s2">small</span><span class="dl">"</span>
              <span class="nx">color</span><span class="o">=</span><span class="dl">"</span><span class="s2">black</span><span class="dl">"</span>
              <span class="nx">style</span><span class="o">=</span><span class="p">{</span><span class="nx">styles</span><span class="p">.</span><span class="nx">spinner</span><span class="p">}</span>
            <span class="sr">/</span><span class="err">&gt;
</span>          <span class="p">)}</span>
        <span class="o">&lt;</span><span class="sr">/</span><span class="err">&gt;
</span>      <span class="p">)}</span>
      <span class="nx">onEndReachedThrehold</span><span class="o">=</span><span class="p">{</span><span class="mf">0.5</span><span class="p">}</span>
      <span class="nx">onEndReached</span><span class="o">=</span><span class="p">{</span><span class="nx">fetchNextPage</span><span class="p">}</span>
    <span class="sr">/</span><span class="err">&gt;
</span>  <span class="p">);</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="nx">StyleSheet</span><span class="p">.</span><span class="nf">create</span><span class="p">({</span>
  <span class="na">list</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">flex</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">separator</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">width</span><span class="p">:</span> <span class="dl">'</span><span class="s1">100%</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">height</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">#cfd8dc</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">spinner</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">backgroundColor</span><span class="p">:</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">paddingTop</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
    <span class="na">paddingBottom</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">})</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/react-native/'>React-Native</a>, <a href='/categories/react-query/'>React-Query</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/react-query/" class="post-tag no-text-decoration" >react-query</a> <a href="/tags/react-native/" class="post-tag no-text-decoration" >react-native</a> <a href="/tags/usequery/" class="post-tag no-text-decoration" >useQuery</a> <a href="/tags/usemutation/" class="post-tag no-text-decoration" >useMutation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=React-Native+React-Query+-+Narvis2&url=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FReact-Native-Query%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=React-Native+React-Query+-+Narvis2&u=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FReact-Native-Query%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fnarvis2.github.io%2Fposts%2FReact-Native-Query%2F&text=React-Native+React-Query+-+Narvis2" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/iOS-SwiftUi-ViewModel/">iOS SwiftUi ViewModel</a><li><a href="/posts/Android-Activity-Lifecycle/">Android Activity Lifecycle 생명주기 정리</a><li><a href="/posts/Javascript-Promise-Async-Await/">JavaScript 비동기 작업 Promise, async, await 알아보기</a><li><a href="/posts/iOS-Swift-Alamofire/">iOS SwiftUi Alamofire 기초</a><li><a href="/posts/iOS-Swift-Combine-Basic/">iOS SwiftUi Combine 기초</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/react-native/">react-native</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/jetpack/">jetpack</a> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/redux/">redux</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/uikit/">UIKit</a> <a class="post-tag" href="/tags/coroutine/">coroutine</a> <a class="post-tag" href="/tags/class/">class</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Reat-Native-Redux-Middleware/"><div class="card-body"> <em class="small" data-ts="1669794120" data-df="YYYY-MM-DD" > 2022-11-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>React-Native Redux Middleware</h3><div class="text-muted small"><p> 안녕하세요. Narvis2 입니다. 이번 시간에는 Redux Middleware에 대하여 알아보도록 하겠습니다. Redux Middleware는 REST API 요청 상태를 관리하기 위해 주로 사용합니다. Redux Middleware를 사용하면 Action이 Dispatch된 다음, Reducer에서 해당 Action을 받아와서 Update하기 전에...</p></div></div></a></div><div class="card"> <a href="/posts/React-Native-Context-API/"><div class="card-body"> <em class="small" data-ts="1661151780" data-df="YYYY-MM-DD" > 2022-08-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>React-Native Context API</h3><div class="text-muted small"><p> 안녕하세요. Narvis2입니다. 이번 시간에는 React-Native Context API 에 관하여 알아볼까 합니다. Context API는 react에 내장된 기능으로 Props를 사용하지 않아도 특정 값이 필요한 Component끼리 쉽게 값을 공유할 수 있게 해줍니다. 주로 프로젝트에서 전역 상태를 관리할 때 많이 사용합니다. 🚩 Conte...</p></div></div></a></div><div class="card"> <a href="/posts/React-Native-Hook/"><div class="card-body"> <em class="small" data-ts="1661229420" data-df="YYYY-MM-DD" > 2022-08-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>React-Native Hook</h3><div class="text-muted small"><p> 안녕하세요. Narvis2입니다. 이번 시간에는 React-Native Hook 에 관하여 알아볼까 합니다. React 에는 use로 시작하는 다양한 함수가 내장되어 있는데, 이 함수들을 Hook이라고 부릅니다. Hook을 사용하여 상태 관리, 최적화, 컴포넌트 작동 흐름 관리 등 다양한 기능을 구현할 수 있습니다. 🚩 Hook 의 규칙 H...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/React-Native-Redux/" class="btn btn-outline-primary" prompt="이전 글"><p>React-Native Redux로 전역 상태 관리하기</p></a> <a href="/posts/Android-Jetpack-Compose/" class="btn btn-outline-primary" prompt="다음 글"><p>Android Compose 기초</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/narvis2">narvis2</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/react-native/">react-native</a> <a class="post-tag" href="/tags/compose/">compose</a> <a class="post-tag" href="/tags/jetpack/">jetpack</a> <a class="post-tag" href="/tags/ios/">iOS</a> <a class="post-tag" href="/tags/redux/">redux</a> <a class="post-tag" href="/tags/typescript/">typescript</a> <a class="post-tag" href="/tags/uikit/">UIKit</a> <a class="post-tag" href="/tags/coroutine/">coroutine</a> <a class="post-tag" href="/tags/class/">class</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
